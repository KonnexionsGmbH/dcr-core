
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Document Content Recognition API">
      
      
        <meta name="author" content="Konnexions GmbH Team">
      
      
        <link rel="canonical" href="https://www.konnexions.ch/application_api_documentation/">
      
      
        <link rel="prev" href="../application_operations/">
      
      
        <link rel="next" href="../application_document_language/">
      
      <link rel="icon" href="../img/Icon.png">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-9.0.9">
    
    
      
        <title>API Documentation - DCR-CORE - Document Content Recognition API</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.0d440cfe.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.2505c338.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../assets/pymdownx-extras/extra-b1466b3f51.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="red">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#dcr-core-application-api-documentation" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="DCR-CORE - Document Content Recognition API" class="md-header__button md-logo" aria-label="DCR-CORE - Document Content Recognition API" data-md-component="logo">
      
  <img src="../img/Logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            DCR-CORE - Document Content Recognition API
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              API Documentation
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/KonnexionsGmbH/dcr-core/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="DCR-CORE - Document Content Recognition API" class="md-nav__button md-logo" aria-label="DCR-CORE - Document Content Recognition API" data-md-component="logo">
      
  <img src="../img/Logo.png" alt="logo">

    </a>
    DCR-CORE - Document Content Recognition API
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/KonnexionsGmbH/dcr-core/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
      
      
      
        <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
          Application
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Application
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../application_requirements/" class="md-nav__link">
        Requirements
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../application_installation/" class="md-nav__link">
        Installaion
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../application_configuration/" class="md-nav__link">
        Configuration
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../application_operations/" class="md-nav__link">
        Operations
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          API Documentation
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        API Documentation
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#documentation-for-cls_process" class="md-nav__link">
    Documentation for cls_process
  </a>
  
    <nav class="md-nav" aria-label="Documentation for cls_process">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#src.dcr_core.cls_process.Process" class="md-nav__link">
    src.dcr_core.cls_process.Process
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.dcr_core.cls_process.Process.document" class="md-nav__link">
    document()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.dcr_core.cls_process.Process.pandoc" class="md-nav__link">
    pandoc()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.dcr_core.cls_process.Process.parser" class="md-nav__link">
    parser()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.dcr_core.cls_process.Process.pdf2image" class="md-nav__link">
    pdf2image()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.dcr_core.cls_process.Process.pdflib" class="md-nav__link">
    pdflib()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.dcr_core.cls_process.Process.tesseract" class="md-nav__link">
    tesseract()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.dcr_core.cls_process.Process.tokenizer" class="md-nav__link">
    tokenizer()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../application_document_language/" class="md-nav__link">
        Document Language
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
      
      
      
        <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
          Release Documents
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Release Documents
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release_notes/" class="md-nav__link">
        Release Notes
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release_history/" class="md-nav__link">
        Release History
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
      
      
      
        <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
          Development
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Development
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../development_research_notes/" class="md-nav__link">
        Research Notes
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../development_environment/" class="md-nav__link">
        Environment
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../development_coding_standards/" class="md-nav__link">
        Coding Standards
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../development_code_formatting/" class="md-nav__link">
        Code Formatting
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../development_static_code_analysis/" class="md-nav__link">
        Static Code Analysis
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_6" >
      
      
      
        <label class="md-nav__link" for="__nav_4_6" id="__nav_4_6_label" tabindex="0">
          Documentation
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_6_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4_6">
          <span class="md-nav__icon md-icon"></span>
          Documentation
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../development_software_documentation/" class="md-nav__link">
        Software Documentation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../development_line_type/" class="md-nav__link">
        Line Type Algorithms
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../development_software_testing/" class="md-nav__link">
        Software Testing
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../development_continuous_delivery/" class="md-nav__link">
        Continuous Delivery
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../development_version_planning/" class="md-nav__link">
        Version Planning
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../code_of_conduct/" class="md-nav__link">
        Code of Conduct
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../contributing/" class="md-nav__link">
        Contributing Guide
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../license/" class="md-nav__link">
        License
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#documentation-for-cls_process" class="md-nav__link">
    Documentation for cls_process
  </a>
  
    <nav class="md-nav" aria-label="Documentation for cls_process">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#src.dcr_core.cls_process.Process" class="md-nav__link">
    src.dcr_core.cls_process.Process
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.dcr_core.cls_process.Process.document" class="md-nav__link">
    document()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.dcr_core.cls_process.Process.pandoc" class="md-nav__link">
    pandoc()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.dcr_core.cls_process.Process.parser" class="md-nav__link">
    parser()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.dcr_core.cls_process.Process.pdf2image" class="md-nav__link">
    pdf2image()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.dcr_core.cls_process.Process.pdflib" class="md-nav__link">
    pdflib()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.dcr_core.cls_process.Process.tesseract" class="md-nav__link">
    tesseract()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.dcr_core.cls_process.Process.tokenizer" class="md-nav__link">
    tokenizer()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="dcr-core-application-api-documentation">DCR-CORE - Application - API Documentation</h1>
<p><img alt="GitHub (Pre-)Release" src="https://img.shields.io/github/v/release/KonnexionsGmbH/dcr-core?include_prereleases" />
<img alt="GitHub (Pre-)Release Date" src="https://img.shields.io/github/release-date-pre/KonnexionsGmbh/dcr-core" /></p>
<h2 id="documentation-for-cls_process">Documentation for <code>cls_process</code></h2>


<div class="doc doc-object doc-class">


<a id="src.dcr_core.cls_process.Process"></a>
  <div class="doc doc-contents first">

  
      <p>Process utility class.</p>


        <details class="quote">
          <summary>Source code in <code>src/dcr_core/cls_process.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">  29</span>
<span class="normal">  30</span>
<span class="normal">  31</span>
<span class="normal">  32</span>
<span class="normal">  33</span>
<span class="normal">  34</span>
<span class="normal">  35</span>
<span class="normal">  36</span>
<span class="normal">  37</span>
<span class="normal">  38</span>
<span class="normal">  39</span>
<span class="normal">  40</span>
<span class="normal">  41</span>
<span class="normal">  42</span>
<span class="normal">  43</span>
<span class="normal">  44</span>
<span class="normal">  45</span>
<span class="normal">  46</span>
<span class="normal">  47</span>
<span class="normal">  48</span>
<span class="normal">  49</span>
<span class="normal">  50</span>
<span class="normal">  51</span>
<span class="normal">  52</span>
<span class="normal">  53</span>
<span class="normal">  54</span>
<span class="normal">  55</span>
<span class="normal">  56</span>
<span class="normal">  57</span>
<span class="normal">  58</span>
<span class="normal">  59</span>
<span class="normal">  60</span>
<span class="normal">  61</span>
<span class="normal">  62</span>
<span class="normal">  63</span>
<span class="normal">  64</span>
<span class="normal">  65</span>
<span class="normal">  66</span>
<span class="normal">  67</span>
<span class="normal">  68</span>
<span class="normal">  69</span>
<span class="normal">  70</span>
<span class="normal">  71</span>
<span class="normal">  72</span>
<span class="normal">  73</span>
<span class="normal">  74</span>
<span class="normal">  75</span>
<span class="normal">  76</span>
<span class="normal">  77</span>
<span class="normal">  78</span>
<span class="normal">  79</span>
<span class="normal">  80</span>
<span class="normal">  81</span>
<span class="normal">  82</span>
<span class="normal">  83</span>
<span class="normal">  84</span>
<span class="normal">  85</span>
<span class="normal">  86</span>
<span class="normal">  87</span>
<span class="normal">  88</span>
<span class="normal">  89</span>
<span class="normal">  90</span>
<span class="normal">  91</span>
<span class="normal">  92</span>
<span class="normal">  93</span>
<span class="normal">  94</span>
<span class="normal">  95</span>
<span class="normal">  96</span>
<span class="normal">  97</span>
<span class="normal">  98</span>
<span class="normal">  99</span>
<span class="normal"> 100</span>
<span class="normal"> 101</span>
<span class="normal"> 102</span>
<span class="normal"> 103</span>
<span class="normal"> 104</span>
<span class="normal"> 105</span>
<span class="normal"> 106</span>
<span class="normal"> 107</span>
<span class="normal"> 108</span>
<span class="normal"> 109</span>
<span class="normal"> 110</span>
<span class="normal"> 111</span>
<span class="normal"> 112</span>
<span class="normal"> 113</span>
<span class="normal"> 114</span>
<span class="normal"> 115</span>
<span class="normal"> 116</span>
<span class="normal"> 117</span>
<span class="normal"> 118</span>
<span class="normal"> 119</span>
<span class="normal"> 120</span>
<span class="normal"> 121</span>
<span class="normal"> 122</span>
<span class="normal"> 123</span>
<span class="normal"> 124</span>
<span class="normal"> 125</span>
<span class="normal"> 126</span>
<span class="normal"> 127</span>
<span class="normal"> 128</span>
<span class="normal"> 129</span>
<span class="normal"> 130</span>
<span class="normal"> 131</span>
<span class="normal"> 132</span>
<span class="normal"> 133</span>
<span class="normal"> 134</span>
<span class="normal"> 135</span>
<span class="normal"> 136</span>
<span class="normal"> 137</span>
<span class="normal"> 138</span>
<span class="normal"> 139</span>
<span class="normal"> 140</span>
<span class="normal"> 141</span>
<span class="normal"> 142</span>
<span class="normal"> 143</span>
<span class="normal"> 144</span>
<span class="normal"> 145</span>
<span class="normal"> 146</span>
<span class="normal"> 147</span>
<span class="normal"> 148</span>
<span class="normal"> 149</span>
<span class="normal"> 150</span>
<span class="normal"> 151</span>
<span class="normal"> 152</span>
<span class="normal"> 153</span>
<span class="normal"> 154</span>
<span class="normal"> 155</span>
<span class="normal"> 156</span>
<span class="normal"> 157</span>
<span class="normal"> 158</span>
<span class="normal"> 159</span>
<span class="normal"> 160</span>
<span class="normal"> 161</span>
<span class="normal"> 162</span>
<span class="normal"> 163</span>
<span class="normal"> 164</span>
<span class="normal"> 165</span>
<span class="normal"> 166</span>
<span class="normal"> 167</span>
<span class="normal"> 168</span>
<span class="normal"> 169</span>
<span class="normal"> 170</span>
<span class="normal"> 171</span>
<span class="normal"> 172</span>
<span class="normal"> 173</span>
<span class="normal"> 174</span>
<span class="normal"> 175</span>
<span class="normal"> 176</span>
<span class="normal"> 177</span>
<span class="normal"> 178</span>
<span class="normal"> 179</span>
<span class="normal"> 180</span>
<span class="normal"> 181</span>
<span class="normal"> 182</span>
<span class="normal"> 183</span>
<span class="normal"> 184</span>
<span class="normal"> 185</span>
<span class="normal"> 186</span>
<span class="normal"> 187</span>
<span class="normal"> 188</span>
<span class="normal"> 189</span>
<span class="normal"> 190</span>
<span class="normal"> 191</span>
<span class="normal"> 192</span>
<span class="normal"> 193</span>
<span class="normal"> 194</span>
<span class="normal"> 195</span>
<span class="normal"> 196</span>
<span class="normal"> 197</span>
<span class="normal"> 198</span>
<span class="normal"> 199</span>
<span class="normal"> 200</span>
<span class="normal"> 201</span>
<span class="normal"> 202</span>
<span class="normal"> 203</span>
<span class="normal"> 204</span>
<span class="normal"> 205</span>
<span class="normal"> 206</span>
<span class="normal"> 207</span>
<span class="normal"> 208</span>
<span class="normal"> 209</span>
<span class="normal"> 210</span>
<span class="normal"> 211</span>
<span class="normal"> 212</span>
<span class="normal"> 213</span>
<span class="normal"> 214</span>
<span class="normal"> 215</span>
<span class="normal"> 216</span>
<span class="normal"> 217</span>
<span class="normal"> 218</span>
<span class="normal"> 219</span>
<span class="normal"> 220</span>
<span class="normal"> 221</span>
<span class="normal"> 222</span>
<span class="normal"> 223</span>
<span class="normal"> 224</span>
<span class="normal"> 225</span>
<span class="normal"> 226</span>
<span class="normal"> 227</span>
<span class="normal"> 228</span>
<span class="normal"> 229</span>
<span class="normal"> 230</span>
<span class="normal"> 231</span>
<span class="normal"> 232</span>
<span class="normal"> 233</span>
<span class="normal"> 234</span>
<span class="normal"> 235</span>
<span class="normal"> 236</span>
<span class="normal"> 237</span>
<span class="normal"> 238</span>
<span class="normal"> 239</span>
<span class="normal"> 240</span>
<span class="normal"> 241</span>
<span class="normal"> 242</span>
<span class="normal"> 243</span>
<span class="normal"> 244</span>
<span class="normal"> 245</span>
<span class="normal"> 246</span>
<span class="normal"> 247</span>
<span class="normal"> 248</span>
<span class="normal"> 249</span>
<span class="normal"> 250</span>
<span class="normal"> 251</span>
<span class="normal"> 252</span>
<span class="normal"> 253</span>
<span class="normal"> 254</span>
<span class="normal"> 255</span>
<span class="normal"> 256</span>
<span class="normal"> 257</span>
<span class="normal"> 258</span>
<span class="normal"> 259</span>
<span class="normal"> 260</span>
<span class="normal"> 261</span>
<span class="normal"> 262</span>
<span class="normal"> 263</span>
<span class="normal"> 264</span>
<span class="normal"> 265</span>
<span class="normal"> 266</span>
<span class="normal"> 267</span>
<span class="normal"> 268</span>
<span class="normal"> 269</span>
<span class="normal"> 270</span>
<span class="normal"> 271</span>
<span class="normal"> 272</span>
<span class="normal"> 273</span>
<span class="normal"> 274</span>
<span class="normal"> 275</span>
<span class="normal"> 276</span>
<span class="normal"> 277</span>
<span class="normal"> 278</span>
<span class="normal"> 279</span>
<span class="normal"> 280</span>
<span class="normal"> 281</span>
<span class="normal"> 282</span>
<span class="normal"> 283</span>
<span class="normal"> 284</span>
<span class="normal"> 285</span>
<span class="normal"> 286</span>
<span class="normal"> 287</span>
<span class="normal"> 288</span>
<span class="normal"> 289</span>
<span class="normal"> 290</span>
<span class="normal"> 291</span>
<span class="normal"> 292</span>
<span class="normal"> 293</span>
<span class="normal"> 294</span>
<span class="normal"> 295</span>
<span class="normal"> 296</span>
<span class="normal"> 297</span>
<span class="normal"> 298</span>
<span class="normal"> 299</span>
<span class="normal"> 300</span>
<span class="normal"> 301</span>
<span class="normal"> 302</span>
<span class="normal"> 303</span>
<span class="normal"> 304</span>
<span class="normal"> 305</span>
<span class="normal"> 306</span>
<span class="normal"> 307</span>
<span class="normal"> 308</span>
<span class="normal"> 309</span>
<span class="normal"> 310</span>
<span class="normal"> 311</span>
<span class="normal"> 312</span>
<span class="normal"> 313</span>
<span class="normal"> 314</span>
<span class="normal"> 315</span>
<span class="normal"> 316</span>
<span class="normal"> 317</span>
<span class="normal"> 318</span>
<span class="normal"> 319</span>
<span class="normal"> 320</span>
<span class="normal"> 321</span>
<span class="normal"> 322</span>
<span class="normal"> 323</span>
<span class="normal"> 324</span>
<span class="normal"> 325</span>
<span class="normal"> 326</span>
<span class="normal"> 327</span>
<span class="normal"> 328</span>
<span class="normal"> 329</span>
<span class="normal"> 330</span>
<span class="normal"> 331</span>
<span class="normal"> 332</span>
<span class="normal"> 333</span>
<span class="normal"> 334</span>
<span class="normal"> 335</span>
<span class="normal"> 336</span>
<span class="normal"> 337</span>
<span class="normal"> 338</span>
<span class="normal"> 339</span>
<span class="normal"> 340</span>
<span class="normal"> 341</span>
<span class="normal"> 342</span>
<span class="normal"> 343</span>
<span class="normal"> 344</span>
<span class="normal"> 345</span>
<span class="normal"> 346</span>
<span class="normal"> 347</span>
<span class="normal"> 348</span>
<span class="normal"> 349</span>
<span class="normal"> 350</span>
<span class="normal"> 351</span>
<span class="normal"> 352</span>
<span class="normal"> 353</span>
<span class="normal"> 354</span>
<span class="normal"> 355</span>
<span class="normal"> 356</span>
<span class="normal"> 357</span>
<span class="normal"> 358</span>
<span class="normal"> 359</span>
<span class="normal"> 360</span>
<span class="normal"> 361</span>
<span class="normal"> 362</span>
<span class="normal"> 363</span>
<span class="normal"> 364</span>
<span class="normal"> 365</span>
<span class="normal"> 366</span>
<span class="normal"> 367</span>
<span class="normal"> 368</span>
<span class="normal"> 369</span>
<span class="normal"> 370</span>
<span class="normal"> 371</span>
<span class="normal"> 372</span>
<span class="normal"> 373</span>
<span class="normal"> 374</span>
<span class="normal"> 375</span>
<span class="normal"> 376</span>
<span class="normal"> 377</span>
<span class="normal"> 378</span>
<span class="normal"> 379</span>
<span class="normal"> 380</span>
<span class="normal"> 381</span>
<span class="normal"> 382</span>
<span class="normal"> 383</span>
<span class="normal"> 384</span>
<span class="normal"> 385</span>
<span class="normal"> 386</span>
<span class="normal"> 387</span>
<span class="normal"> 388</span>
<span class="normal"> 389</span>
<span class="normal"> 390</span>
<span class="normal"> 391</span>
<span class="normal"> 392</span>
<span class="normal"> 393</span>
<span class="normal"> 394</span>
<span class="normal"> 395</span>
<span class="normal"> 396</span>
<span class="normal"> 397</span>
<span class="normal"> 398</span>
<span class="normal"> 399</span>
<span class="normal"> 400</span>
<span class="normal"> 401</span>
<span class="normal"> 402</span>
<span class="normal"> 403</span>
<span class="normal"> 404</span>
<span class="normal"> 405</span>
<span class="normal"> 406</span>
<span class="normal"> 407</span>
<span class="normal"> 408</span>
<span class="normal"> 409</span>
<span class="normal"> 410</span>
<span class="normal"> 411</span>
<span class="normal"> 412</span>
<span class="normal"> 413</span>
<span class="normal"> 414</span>
<span class="normal"> 415</span>
<span class="normal"> 416</span>
<span class="normal"> 417</span>
<span class="normal"> 418</span>
<span class="normal"> 419</span>
<span class="normal"> 420</span>
<span class="normal"> 421</span>
<span class="normal"> 422</span>
<span class="normal"> 423</span>
<span class="normal"> 424</span>
<span class="normal"> 425</span>
<span class="normal"> 426</span>
<span class="normal"> 427</span>
<span class="normal"> 428</span>
<span class="normal"> 429</span>
<span class="normal"> 430</span>
<span class="normal"> 431</span>
<span class="normal"> 432</span>
<span class="normal"> 433</span>
<span class="normal"> 434</span>
<span class="normal"> 435</span>
<span class="normal"> 436</span>
<span class="normal"> 437</span>
<span class="normal"> 438</span>
<span class="normal"> 439</span>
<span class="normal"> 440</span>
<span class="normal"> 441</span>
<span class="normal"> 442</span>
<span class="normal"> 443</span>
<span class="normal"> 444</span>
<span class="normal"> 445</span>
<span class="normal"> 446</span>
<span class="normal"> 447</span>
<span class="normal"> 448</span>
<span class="normal"> 449</span>
<span class="normal"> 450</span>
<span class="normal"> 451</span>
<span class="normal"> 452</span>
<span class="normal"> 453</span>
<span class="normal"> 454</span>
<span class="normal"> 455</span>
<span class="normal"> 456</span>
<span class="normal"> 457</span>
<span class="normal"> 458</span>
<span class="normal"> 459</span>
<span class="normal"> 460</span>
<span class="normal"> 461</span>
<span class="normal"> 462</span>
<span class="normal"> 463</span>
<span class="normal"> 464</span>
<span class="normal"> 465</span>
<span class="normal"> 466</span>
<span class="normal"> 467</span>
<span class="normal"> 468</span>
<span class="normal"> 469</span>
<span class="normal"> 470</span>
<span class="normal"> 471</span>
<span class="normal"> 472</span>
<span class="normal"> 473</span>
<span class="normal"> 474</span>
<span class="normal"> 475</span>
<span class="normal"> 476</span>
<span class="normal"> 477</span>
<span class="normal"> 478</span>
<span class="normal"> 479</span>
<span class="normal"> 480</span>
<span class="normal"> 481</span>
<span class="normal"> 482</span>
<span class="normal"> 483</span>
<span class="normal"> 484</span>
<span class="normal"> 485</span>
<span class="normal"> 486</span>
<span class="normal"> 487</span>
<span class="normal"> 488</span>
<span class="normal"> 489</span>
<span class="normal"> 490</span>
<span class="normal"> 491</span>
<span class="normal"> 492</span>
<span class="normal"> 493</span>
<span class="normal"> 494</span>
<span class="normal"> 495</span>
<span class="normal"> 496</span>
<span class="normal"> 497</span>
<span class="normal"> 498</span>
<span class="normal"> 499</span>
<span class="normal"> 500</span>
<span class="normal"> 501</span>
<span class="normal"> 502</span>
<span class="normal"> 503</span>
<span class="normal"> 504</span>
<span class="normal"> 505</span>
<span class="normal"> 506</span>
<span class="normal"> 507</span>
<span class="normal"> 508</span>
<span class="normal"> 509</span>
<span class="normal"> 510</span>
<span class="normal"> 511</span>
<span class="normal"> 512</span>
<span class="normal"> 513</span>
<span class="normal"> 514</span>
<span class="normal"> 515</span>
<span class="normal"> 516</span>
<span class="normal"> 517</span>
<span class="normal"> 518</span>
<span class="normal"> 519</span>
<span class="normal"> 520</span>
<span class="normal"> 521</span>
<span class="normal"> 522</span>
<span class="normal"> 523</span>
<span class="normal"> 524</span>
<span class="normal"> 525</span>
<span class="normal"> 526</span>
<span class="normal"> 527</span>
<span class="normal"> 528</span>
<span class="normal"> 529</span>
<span class="normal"> 530</span>
<span class="normal"> 531</span>
<span class="normal"> 532</span>
<span class="normal"> 533</span>
<span class="normal"> 534</span>
<span class="normal"> 535</span>
<span class="normal"> 536</span>
<span class="normal"> 537</span>
<span class="normal"> 538</span>
<span class="normal"> 539</span>
<span class="normal"> 540</span>
<span class="normal"> 541</span>
<span class="normal"> 542</span>
<span class="normal"> 543</span>
<span class="normal"> 544</span>
<span class="normal"> 545</span>
<span class="normal"> 546</span>
<span class="normal"> 547</span>
<span class="normal"> 548</span>
<span class="normal"> 549</span>
<span class="normal"> 550</span>
<span class="normal"> 551</span>
<span class="normal"> 552</span>
<span class="normal"> 553</span>
<span class="normal"> 554</span>
<span class="normal"> 555</span>
<span class="normal"> 556</span>
<span class="normal"> 557</span>
<span class="normal"> 558</span>
<span class="normal"> 559</span>
<span class="normal"> 560</span>
<span class="normal"> 561</span>
<span class="normal"> 562</span>
<span class="normal"> 563</span>
<span class="normal"> 564</span>
<span class="normal"> 565</span>
<span class="normal"> 566</span>
<span class="normal"> 567</span>
<span class="normal"> 568</span>
<span class="normal"> 569</span>
<span class="normal"> 570</span>
<span class="normal"> 571</span>
<span class="normal"> 572</span>
<span class="normal"> 573</span>
<span class="normal"> 574</span>
<span class="normal"> 575</span>
<span class="normal"> 576</span>
<span class="normal"> 577</span>
<span class="normal"> 578</span>
<span class="normal"> 579</span>
<span class="normal"> 580</span>
<span class="normal"> 581</span>
<span class="normal"> 582</span>
<span class="normal"> 583</span>
<span class="normal"> 584</span>
<span class="normal"> 585</span>
<span class="normal"> 586</span>
<span class="normal"> 587</span>
<span class="normal"> 588</span>
<span class="normal"> 589</span>
<span class="normal"> 590</span>
<span class="normal"> 591</span>
<span class="normal"> 592</span>
<span class="normal"> 593</span>
<span class="normal"> 594</span>
<span class="normal"> 595</span>
<span class="normal"> 596</span>
<span class="normal"> 597</span>
<span class="normal"> 598</span>
<span class="normal"> 599</span>
<span class="normal"> 600</span>
<span class="normal"> 601</span>
<span class="normal"> 602</span>
<span class="normal"> 603</span>
<span class="normal"> 604</span>
<span class="normal"> 605</span>
<span class="normal"> 606</span>
<span class="normal"> 607</span>
<span class="normal"> 608</span>
<span class="normal"> 609</span>
<span class="normal"> 610</span>
<span class="normal"> 611</span>
<span class="normal"> 612</span>
<span class="normal"> 613</span>
<span class="normal"> 614</span>
<span class="normal"> 615</span>
<span class="normal"> 616</span>
<span class="normal"> 617</span>
<span class="normal"> 618</span>
<span class="normal"> 619</span>
<span class="normal"> 620</span>
<span class="normal"> 621</span>
<span class="normal"> 622</span>
<span class="normal"> 623</span>
<span class="normal"> 624</span>
<span class="normal"> 625</span>
<span class="normal"> 626</span>
<span class="normal"> 627</span>
<span class="normal"> 628</span>
<span class="normal"> 629</span>
<span class="normal"> 630</span>
<span class="normal"> 631</span>
<span class="normal"> 632</span>
<span class="normal"> 633</span>
<span class="normal"> 634</span>
<span class="normal"> 635</span>
<span class="normal"> 636</span>
<span class="normal"> 637</span>
<span class="normal"> 638</span>
<span class="normal"> 639</span>
<span class="normal"> 640</span>
<span class="normal"> 641</span>
<span class="normal"> 642</span>
<span class="normal"> 643</span>
<span class="normal"> 644</span>
<span class="normal"> 645</span>
<span class="normal"> 646</span>
<span class="normal"> 647</span>
<span class="normal"> 648</span>
<span class="normal"> 649</span>
<span class="normal"> 650</span>
<span class="normal"> 651</span>
<span class="normal"> 652</span>
<span class="normal"> 653</span>
<span class="normal"> 654</span>
<span class="normal"> 655</span>
<span class="normal"> 656</span>
<span class="normal"> 657</span>
<span class="normal"> 658</span>
<span class="normal"> 659</span>
<span class="normal"> 660</span>
<span class="normal"> 661</span>
<span class="normal"> 662</span>
<span class="normal"> 663</span>
<span class="normal"> 664</span>
<span class="normal"> 665</span>
<span class="normal"> 666</span>
<span class="normal"> 667</span>
<span class="normal"> 668</span>
<span class="normal"> 669</span>
<span class="normal"> 670</span>
<span class="normal"> 671</span>
<span class="normal"> 672</span>
<span class="normal"> 673</span>
<span class="normal"> 674</span>
<span class="normal"> 675</span>
<span class="normal"> 676</span>
<span class="normal"> 677</span>
<span class="normal"> 678</span>
<span class="normal"> 679</span>
<span class="normal"> 680</span>
<span class="normal"> 681</span>
<span class="normal"> 682</span>
<span class="normal"> 683</span>
<span class="normal"> 684</span>
<span class="normal"> 685</span>
<span class="normal"> 686</span>
<span class="normal"> 687</span>
<span class="normal"> 688</span>
<span class="normal"> 689</span>
<span class="normal"> 690</span>
<span class="normal"> 691</span>
<span class="normal"> 692</span>
<span class="normal"> 693</span>
<span class="normal"> 694</span>
<span class="normal"> 695</span>
<span class="normal"> 696</span>
<span class="normal"> 697</span>
<span class="normal"> 698</span>
<span class="normal"> 699</span>
<span class="normal"> 700</span>
<span class="normal"> 701</span>
<span class="normal"> 702</span>
<span class="normal"> 703</span>
<span class="normal"> 704</span>
<span class="normal"> 705</span>
<span class="normal"> 706</span>
<span class="normal"> 707</span>
<span class="normal"> 708</span>
<span class="normal"> 709</span>
<span class="normal"> 710</span>
<span class="normal"> 711</span>
<span class="normal"> 712</span>
<span class="normal"> 713</span>
<span class="normal"> 714</span>
<span class="normal"> 715</span>
<span class="normal"> 716</span>
<span class="normal"> 717</span>
<span class="normal"> 718</span>
<span class="normal"> 719</span>
<span class="normal"> 720</span>
<span class="normal"> 721</span>
<span class="normal"> 722</span>
<span class="normal"> 723</span>
<span class="normal"> 724</span>
<span class="normal"> 725</span>
<span class="normal"> 726</span>
<span class="normal"> 727</span>
<span class="normal"> 728</span>
<span class="normal"> 729</span>
<span class="normal"> 730</span>
<span class="normal"> 731</span>
<span class="normal"> 732</span>
<span class="normal"> 733</span>
<span class="normal"> 734</span>
<span class="normal"> 735</span>
<span class="normal"> 736</span>
<span class="normal"> 737</span>
<span class="normal"> 738</span>
<span class="normal"> 739</span>
<span class="normal"> 740</span>
<span class="normal"> 741</span>
<span class="normal"> 742</span>
<span class="normal"> 743</span>
<span class="normal"> 744</span>
<span class="normal"> 745</span>
<span class="normal"> 746</span>
<span class="normal"> 747</span>
<span class="normal"> 748</span>
<span class="normal"> 749</span>
<span class="normal"> 750</span>
<span class="normal"> 751</span>
<span class="normal"> 752</span>
<span class="normal"> 753</span>
<span class="normal"> 754</span>
<span class="normal"> 755</span>
<span class="normal"> 756</span>
<span class="normal"> 757</span>
<span class="normal"> 758</span>
<span class="normal"> 759</span>
<span class="normal"> 760</span>
<span class="normal"> 761</span>
<span class="normal"> 762</span>
<span class="normal"> 763</span>
<span class="normal"> 764</span>
<span class="normal"> 765</span>
<span class="normal"> 766</span>
<span class="normal"> 767</span>
<span class="normal"> 768</span>
<span class="normal"> 769</span>
<span class="normal"> 770</span>
<span class="normal"> 771</span>
<span class="normal"> 772</span>
<span class="normal"> 773</span>
<span class="normal"> 774</span>
<span class="normal"> 775</span>
<span class="normal"> 776</span>
<span class="normal"> 777</span>
<span class="normal"> 778</span>
<span class="normal"> 779</span>
<span class="normal"> 780</span>
<span class="normal"> 781</span>
<span class="normal"> 782</span>
<span class="normal"> 783</span>
<span class="normal"> 784</span>
<span class="normal"> 785</span>
<span class="normal"> 786</span>
<span class="normal"> 787</span>
<span class="normal"> 788</span>
<span class="normal"> 789</span>
<span class="normal"> 790</span>
<span class="normal"> 791</span>
<span class="normal"> 792</span>
<span class="normal"> 793</span>
<span class="normal"> 794</span>
<span class="normal"> 795</span>
<span class="normal"> 796</span>
<span class="normal"> 797</span>
<span class="normal"> 798</span>
<span class="normal"> 799</span>
<span class="normal"> 800</span>
<span class="normal"> 801</span>
<span class="normal"> 802</span>
<span class="normal"> 803</span>
<span class="normal"> 804</span>
<span class="normal"> 805</span>
<span class="normal"> 806</span>
<span class="normal"> 807</span>
<span class="normal"> 808</span>
<span class="normal"> 809</span>
<span class="normal"> 810</span>
<span class="normal"> 811</span>
<span class="normal"> 812</span>
<span class="normal"> 813</span>
<span class="normal"> 814</span>
<span class="normal"> 815</span>
<span class="normal"> 816</span>
<span class="normal"> 817</span>
<span class="normal"> 818</span>
<span class="normal"> 819</span>
<span class="normal"> 820</span>
<span class="normal"> 821</span>
<span class="normal"> 822</span>
<span class="normal"> 823</span>
<span class="normal"> 824</span>
<span class="normal"> 825</span>
<span class="normal"> 826</span>
<span class="normal"> 827</span>
<span class="normal"> 828</span>
<span class="normal"> 829</span>
<span class="normal"> 830</span>
<span class="normal"> 831</span>
<span class="normal"> 832</span>
<span class="normal"> 833</span>
<span class="normal"> 834</span>
<span class="normal"> 835</span>
<span class="normal"> 836</span>
<span class="normal"> 837</span>
<span class="normal"> 838</span>
<span class="normal"> 839</span>
<span class="normal"> 840</span>
<span class="normal"> 841</span>
<span class="normal"> 842</span>
<span class="normal"> 843</span>
<span class="normal"> 844</span>
<span class="normal"> 845</span>
<span class="normal"> 846</span>
<span class="normal"> 847</span>
<span class="normal"> 848</span>
<span class="normal"> 849</span>
<span class="normal"> 850</span>
<span class="normal"> 851</span>
<span class="normal"> 852</span>
<span class="normal"> 853</span>
<span class="normal"> 854</span>
<span class="normal"> 855</span>
<span class="normal"> 856</span>
<span class="normal"> 857</span>
<span class="normal"> 858</span>
<span class="normal"> 859</span>
<span class="normal"> 860</span>
<span class="normal"> 861</span>
<span class="normal"> 862</span>
<span class="normal"> 863</span>
<span class="normal"> 864</span>
<span class="normal"> 865</span>
<span class="normal"> 866</span>
<span class="normal"> 867</span>
<span class="normal"> 868</span>
<span class="normal"> 869</span>
<span class="normal"> 870</span>
<span class="normal"> 871</span>
<span class="normal"> 872</span>
<span class="normal"> 873</span>
<span class="normal"> 874</span>
<span class="normal"> 875</span>
<span class="normal"> 876</span>
<span class="normal"> 877</span>
<span class="normal"> 878</span>
<span class="normal"> 879</span>
<span class="normal"> 880</span>
<span class="normal"> 881</span>
<span class="normal"> 882</span>
<span class="normal"> 883</span>
<span class="normal"> 884</span>
<span class="normal"> 885</span>
<span class="normal"> 886</span>
<span class="normal"> 887</span>
<span class="normal"> 888</span>
<span class="normal"> 889</span>
<span class="normal"> 890</span>
<span class="normal"> 891</span>
<span class="normal"> 892</span>
<span class="normal"> 893</span>
<span class="normal"> 894</span>
<span class="normal"> 895</span>
<span class="normal"> 896</span>
<span class="normal"> 897</span>
<span class="normal"> 898</span>
<span class="normal"> 899</span>
<span class="normal"> 900</span>
<span class="normal"> 901</span>
<span class="normal"> 902</span>
<span class="normal"> 903</span>
<span class="normal"> 904</span>
<span class="normal"> 905</span>
<span class="normal"> 906</span>
<span class="normal"> 907</span>
<span class="normal"> 908</span>
<span class="normal"> 909</span>
<span class="normal"> 910</span>
<span class="normal"> 911</span>
<span class="normal"> 912</span>
<span class="normal"> 913</span>
<span class="normal"> 914</span>
<span class="normal"> 915</span>
<span class="normal"> 916</span>
<span class="normal"> 917</span>
<span class="normal"> 918</span>
<span class="normal"> 919</span>
<span class="normal"> 920</span>
<span class="normal"> 921</span>
<span class="normal"> 922</span>
<span class="normal"> 923</span>
<span class="normal"> 924</span>
<span class="normal"> 925</span>
<span class="normal"> 926</span>
<span class="normal"> 927</span>
<span class="normal"> 928</span>
<span class="normal"> 929</span>
<span class="normal"> 930</span>
<span class="normal"> 931</span>
<span class="normal"> 932</span>
<span class="normal"> 933</span>
<span class="normal"> 934</span>
<span class="normal"> 935</span>
<span class="normal"> 936</span>
<span class="normal"> 937</span>
<span class="normal"> 938</span>
<span class="normal"> 939</span>
<span class="normal"> 940</span>
<span class="normal"> 941</span>
<span class="normal"> 942</span>
<span class="normal"> 943</span>
<span class="normal"> 944</span>
<span class="normal"> 945</span>
<span class="normal"> 946</span>
<span class="normal"> 947</span>
<span class="normal"> 948</span>
<span class="normal"> 949</span>
<span class="normal"> 950</span>
<span class="normal"> 951</span>
<span class="normal"> 952</span>
<span class="normal"> 953</span>
<span class="normal"> 954</span>
<span class="normal"> 955</span>
<span class="normal"> 956</span>
<span class="normal"> 957</span>
<span class="normal"> 958</span>
<span class="normal"> 959</span>
<span class="normal"> 960</span>
<span class="normal"> 961</span>
<span class="normal"> 962</span>
<span class="normal"> 963</span>
<span class="normal"> 964</span>
<span class="normal"> 965</span>
<span class="normal"> 966</span>
<span class="normal"> 967</span>
<span class="normal"> 968</span>
<span class="normal"> 969</span>
<span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span>
<span class="normal">1167</span>
<span class="normal">1168</span>
<span class="normal">1169</span>
<span class="normal">1170</span>
<span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span>
<span class="normal">1174</span>
<span class="normal">1175</span>
<span class="normal">1176</span>
<span class="normal">1177</span>
<span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span>
<span class="normal">1182</span>
<span class="normal">1183</span>
<span class="normal">1184</span>
<span class="normal">1185</span>
<span class="normal">1186</span>
<span class="normal">1187</span>
<span class="normal">1188</span>
<span class="normal">1189</span>
<span class="normal">1190</span>
<span class="normal">1191</span>
<span class="normal">1192</span>
<span class="normal">1193</span>
<span class="normal">1194</span>
<span class="normal">1195</span>
<span class="normal">1196</span>
<span class="normal">1197</span>
<span class="normal">1198</span>
<span class="normal">1199</span>
<span class="normal">1200</span>
<span class="normal">1201</span>
<span class="normal">1202</span>
<span class="normal">1203</span>
<span class="normal">1204</span>
<span class="normal">1205</span>
<span class="normal">1206</span>
<span class="normal">1207</span>
<span class="normal">1208</span>
<span class="normal">1209</span>
<span class="normal">1210</span>
<span class="normal">1211</span>
<span class="normal">1212</span>
<span class="normal">1213</span>
<span class="normal">1214</span>
<span class="normal">1215</span>
<span class="normal">1216</span>
<span class="normal">1217</span>
<span class="normal">1218</span>
<span class="normal">1219</span>
<span class="normal">1220</span>
<span class="normal">1221</span>
<span class="normal">1222</span>
<span class="normal">1223</span>
<span class="normal">1224</span>
<span class="normal">1225</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Process</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Process utility class.&quot;&quot;&quot;</span>

    <span class="c1"># ------------------------------------------------------------------</span>
    <span class="c1"># Class variables.</span>
    <span class="c1"># ------------------------------------------------------------------</span>
    <span class="n">ERROR_01_901</span><span class="p">:</span> <span class="n">ClassVar</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;01.901 Issue (p_i): Document rejected because of unknown file extension=&#39;</span><span class="si">{extension}</span><span class="s2">&#39;.&quot;</span>
    <span class="n">ERROR_01_903</span><span class="p">:</span> <span class="n">ClassVar</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s2">&quot;01.903 Issue (p_i): Error with fitz.open() processing of file &#39;</span><span class="si">{file_name}</span><span class="s2">&#39; &quot;</span> <span class="o">+</span> <span class="s2">&quot;- RuntimeError - error: &#39;</span><span class="si">{error_msg}</span><span class="s2">&#39;&quot;</span>
    <span class="p">)</span>

    <span class="n">ERROR_21_901</span><span class="p">:</span> <span class="n">ClassVar</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s2">&quot;21.901 Issue (p_2_i): Processing file &#39;</span><span class="si">{full_name}</span><span class="s2">&#39; with pdf2image failed - PDFPageCountError - &quot;</span>
        <span class="o">+</span> <span class="s2">&quot;error type: &#39;</span><span class="si">{error_type}</span><span class="s2">&#39; - error: &#39;</span><span class="si">{error_msg}</span><span class="s2">&#39;&quot;</span>
    <span class="p">)</span>
    <span class="n">ERROR_31_902</span><span class="p">:</span> <span class="n">ClassVar</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s2">&quot;31.902 Issue (n_2_p): The file &#39;</span><span class="si">{full_name}</span><span class="s2">&#39; cannot be converted to an &quot;</span> <span class="o">+</span> <span class="s2">&quot;&#39;PDF&#39; document - FileNotFoundError&quot;</span>
    <span class="p">)</span>
    <span class="n">ERROR_31_903</span><span class="p">:</span> <span class="n">ClassVar</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s2">&quot;31.903 Issue (n_2_p): The file &#39;</span><span class="si">{full_name}</span><span class="s2">&#39; cannot be converted to an &quot;</span> <span class="o">+</span> <span class="s2">&quot;&#39;PDF&#39; document - RuntimeError - error: &#39;</span><span class="si">{error_msg}</span><span class="s2">&#39;&quot;</span>
    <span class="p">)</span>
    <span class="n">ERROR_31_911</span><span class="p">:</span> <span class="n">ClassVar</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;31.911 Issue (n_2_p): The pdf document </span><span class="si">{full_name}</span><span class="s2"> for PDFlib TET is an empty file&quot;</span>
    <span class="n">ERROR_41_901</span><span class="p">:</span> <span class="n">ClassVar</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s2">&quot;41.901 Issue (ocr): Converting the file &#39;</span><span class="si">{full_name}</span><span class="s2">&#39; with Tesseract OCR failed - &quot;</span> <span class="o">+</span> <span class="s2">&quot;RuntimeError - error: &#39;</span><span class="si">{error_msg}</span><span class="s2">&#39;&quot;</span>
    <span class="p">)</span>
    <span class="n">ERROR_41_911</span><span class="p">:</span> <span class="n">ClassVar</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;41.911 Issue (ocr): Tesseract OCR has created an empty pdf file from the file </span><span class="si">{full_name}</span><span class="s2">&quot;</span>
    <span class="n">ERROR_51_901</span><span class="p">:</span> <span class="n">ClassVar</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s2">&quot;51.901 Issue (tet): Opening document &#39;</span><span class="si">{full_name}</span><span class="s2">&#39; - &quot;</span> <span class="o">+</span> <span class="s2">&quot;error no: &#39;</span><span class="si">{error_no}</span><span class="s2">&#39; - api: &#39;</span><span class="si">{api_name}</span><span class="s2">&#39; - error: &#39;</span><span class="si">{error_msg}</span><span class="s2">&#39;&quot;</span>
    <span class="p">)</span>
    <span class="n">ERROR_61_901</span><span class="p">:</span> <span class="n">ClassVar</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;61.901 Issue (s_p_j): Parsing the file &#39;</span><span class="si">{full_name}</span><span class="s2">&#39; failed - FileNotFoundError&quot;</span>
    <span class="n">ERROR_71_901</span><span class="p">:</span> <span class="n">ClassVar</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;71.901 Issue (tkn): Tokenizing the file &#39;</span><span class="si">{full_name}</span><span class="s2">&#39; failed - FileNotFoundError&quot;</span>

    <span class="n">PANDOC_PDF_ENGINE_LULATEX</span><span class="p">:</span> <span class="n">ClassVar</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;lulatex&quot;</span>
    <span class="n">PANDOC_PDF_ENGINE_XELATEX</span><span class="p">:</span> <span class="n">ClassVar</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;xelatex&quot;</span>

    <span class="c1"># ------------------------------------------------------------------</span>
    <span class="c1"># Initialise the instance.</span>
    <span class="c1"># ------------------------------------------------------------------</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialise the instance.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">LOGGER_START</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">initialise_logger</span><span class="p">()</span>
            <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">LOGGER_START</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_document_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_directory</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_extension</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_extension_int</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_next_step</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_pandoc</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_parser_line</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_parser_page</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_parser_word</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_pdf2image</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_pdflib</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_stem_name</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_tesseract</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_tokenizer_line</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_tokenizer_page</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_tokenizer_word</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_orig</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_is_delete_auxiliary_files</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_pandoc</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_pdf2image</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_tesseract</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_verbose</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_language_pandoc</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_language_spacy</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_language_tesseract</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_no_lines_footer</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_no_lines_header</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_no_lines_toc</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_no_pdf_pages</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_exist</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">LOGGER_END</span><span class="p">)</span>

    <span class="c1"># ------------------------------------------------------------------</span>
    <span class="c1"># Check the document by the file extension and determine further</span>
    <span class="c1"># processing.</span>
    <span class="c1"># ------------------------------------------------------------------</span>
    <span class="k">def</span> <span class="nf">_document_check_extension</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Document processing control.</span>

<span class="sd">        Check the document by the file extension and determine further</span>
<span class="sd">        processing.</span>

<span class="sd">        Raises:</span>
<span class="sd">            RuntimeError: ERROR_01_903</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">LOGGER_START</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_extension_int</span> <span class="o">==</span> <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">FILE_TYPE_PDF</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">bool</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">page</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span> <span class="k">for</span> <span class="n">page</span> <span class="ow">in</span> <span class="n">fitz</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in</span><span class="p">)])):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_pdflib</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_is_pdf2image</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_is_tesseract</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_pdf2image</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in</span>
            <span class="k">except</span> <span class="ne">RuntimeError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                    <span class="n">Process</span><span class="o">.</span><span class="n">ERROR_01_903</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{file_name}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{error_msg}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">exc</span><span class="p">)),</span>
                <span class="p">)</span> <span class="kn">from</span> <span class="nn">exc</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_extension_int</span> <span class="ow">in</span> <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">FILE_TYPE_PANDOC</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_is_pandoc</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_pandoc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_extension_int</span> <span class="ow">in</span> <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">FILE_TYPE_TESSERACT</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_is_tesseract</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_tesseract</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="n">Process</span><span class="o">.</span><span class="n">ERROR_01_901</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{extension}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_extension_int</span><span class="p">))</span>

        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">LOGGER_END</span><span class="p">)</span>

    <span class="c1"># -----------------------------------------------------------------------------</span>
    <span class="c1"># Delete the given auxiliary file.</span>
    <span class="c1"># -----------------------------------------------------------------------------</span>
    <span class="k">def</span> <span class="nf">_document_delete_auxiliary_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">full_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Delete the given auxiliary file.</span>

<span class="sd">        Args:</span>
<span class="sd">            full_name (str): File name.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_delete_auxiliary_files</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="c1"># Don&#39;t remove the base document !!!</span>
        <span class="k">if</span> <span class="n">full_name</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">full_name</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">full_name</span><span class="p">)</span>
            <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_is_verbose</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Auxiliary file &#39;</span><span class="si">{</span><span class="n">full_name</span><span class="si">}</span><span class="s2">&#39; deleted&quot;</span><span class="p">)</span>

    <span class="c1"># ------------------------------------------------------------------</span>
    <span class="c1"># Initialize the document recognition process.</span>
    <span class="c1"># ------------------------------------------------------------------</span>
    <span class="k">def</span> <span class="nf">_document_init</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize the document recognition process.&quot;&quot;&quot;</span>
        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">LOGGER_START</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_document_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_directory</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_extension</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_extension_int</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_next_step</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_pandoc</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_parser_line</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_parser_page</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_parser_word</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_pdf2image</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_pdflib</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_stem_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_tesseract</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_tokenizer_line</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_tokenizer_page</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_tokenizer_word</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_orig</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_is_pandoc</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_pdf2image</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_tesseract</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_language_pandoc</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_language_spacy</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_language_tesseract</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_no_lines_footer</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_no_lines_header</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_no_lines_toc</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_no_pdf_pages</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">LOGGER_END</span><span class="p">)</span>

    <span class="c1"># ------------------------------------------------------------------</span>
    <span class="c1"># Convert the document to PDF format using Pandoc.</span>
    <span class="c1"># ------------------------------------------------------------------</span>
    <span class="k">def</span> <span class="nf">_document_pandoc</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert the document to PDF format using Pandoc.</span>

<span class="sd">        Raises:</span>
<span class="sd">            RuntimeError: Any Pandoc issue.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_pandoc</span><span class="p">:</span>
            <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">LOGGER_START</span><span class="p">)</span>

            <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_is_verbose</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Start processing Pandoc        </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_pandoc</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_pdflib</span> <span class="o">=</span> <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_utils</span><span class="o">.</span><span class="n">get_full_name_from_components</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_directory</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_stem_name</span><span class="p">,</span> <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">FILE_TYPE_PDF</span>
            <span class="p">)</span>

            <span class="n">return_code</span><span class="p">,</span> <span class="n">error_msg</span> <span class="o">=</span> <span class="n">Process</span><span class="o">.</span><span class="n">pandoc</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_pandoc</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_pdflib</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_language_pandoc</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">return_code</span> <span class="o">!=</span> <span class="s2">&quot;ok&quot;</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="n">error_msg</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_document_delete_auxiliary_file</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_pandoc</span><span class="p">)</span>

            <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_is_verbose</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;End   processing Pandoc        </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_pdflib</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">LOGGER_END</span><span class="p">)</span>

    <span class="c1"># ------------------------------------------------------------------</span>
    <span class="c1"># Extract the text for all granularities from the PDF document.</span>
    <span class="c1"># ------------------------------------------------------------------</span>
    <span class="k">def</span> <span class="nf">_document_parser</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Extract the text for all granularities from the PDF document.&quot;&quot;&quot;</span>
        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">LOGGER_START</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_tokenizer_line</span> <span class="o">=</span> <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_utils</span><span class="o">.</span><span class="n">get_full_name_from_components</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_directory</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_stem_name</span> <span class="o">+</span> <span class="s2">&quot;.&quot;</span> <span class="o">+</span> <span class="n">dcr_core</span><span class="o">.</span><span class="n">cls_nlp_core</span><span class="o">.</span><span class="n">NLPCore</span><span class="o">.</span><span class="n">LINE_XML_VARIATION</span> <span class="o">+</span> <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">FILE_TYPE_JSON</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_tokenizer_page</span> <span class="o">=</span> <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_utils</span><span class="o">.</span><span class="n">get_full_name_from_components</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_directory</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_stem_name</span> <span class="o">+</span> <span class="s2">&quot;.&quot;</span> <span class="o">+</span> <span class="n">dcr_core</span><span class="o">.</span><span class="n">cls_nlp_core</span><span class="o">.</span><span class="n">NLPCore</span><span class="o">.</span><span class="n">PAGE_XML_VARIATION</span> <span class="o">+</span> <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">FILE_TYPE_JSON</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_tokenizer_word</span> <span class="o">=</span> <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_utils</span><span class="o">.</span><span class="n">get_full_name_from_components</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_directory</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_stem_name</span> <span class="o">+</span> <span class="s2">&quot;.&quot;</span> <span class="o">+</span> <span class="n">dcr_core</span><span class="o">.</span><span class="n">cls_nlp_core</span><span class="o">.</span><span class="n">NLPCore</span><span class="o">.</span><span class="n">WORD_XML_VARIATION</span> <span class="o">+</span> <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">FILE_TYPE_JSON</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">for</span> <span class="p">(</span>
            <span class="n">full_name_in_parser</span><span class="p">,</span>
            <span class="n">full_name_in_tokenizer</span><span class="p">,</span>
            <span class="n">tetml_type</span><span class="p">,</span>
            <span class="n">is_parsing_line</span><span class="p">,</span>
            <span class="n">is_parsing_page</span><span class="p">,</span>
            <span class="n">is_parsing_word</span><span class="p">,</span>
        <span class="p">)</span> <span class="ow">in</span> <span class="p">(</span>
            <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_parser_line</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_tokenizer_line</span><span class="p">,</span>
                <span class="n">dcr_core</span><span class="o">.</span><span class="n">cls_nlp_core</span><span class="o">.</span><span class="n">NLPCore</span><span class="o">.</span><span class="n">TETML_TYPE_LINE</span><span class="p">,</span>
                <span class="kc">True</span><span class="p">,</span>
                <span class="kc">False</span><span class="p">,</span>
                <span class="kc">False</span><span class="p">,</span>
            <span class="p">),</span>
            <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_parser_page</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_tokenizer_page</span><span class="p">,</span>
                <span class="n">dcr_core</span><span class="o">.</span><span class="n">cls_nlp_core</span><span class="o">.</span><span class="n">NLPCore</span><span class="o">.</span><span class="n">TETML_TYPE_PAGE</span><span class="p">,</span>
                <span class="kc">False</span><span class="p">,</span>
                <span class="kc">True</span><span class="p">,</span>
                <span class="kc">False</span><span class="p">,</span>
            <span class="p">),</span>
            <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_parser_word</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_tokenizer_word</span><span class="p">,</span>
                <span class="n">dcr_core</span><span class="o">.</span><span class="n">cls_nlp_core</span><span class="o">.</span><span class="n">NLPCore</span><span class="o">.</span><span class="n">TETML_TYPE_WORD</span><span class="p">,</span>
                <span class="kc">False</span><span class="p">,</span>
                <span class="kc">False</span><span class="p">,</span>
                <span class="kc">True</span><span class="p">,</span>
            <span class="p">),</span>
        <span class="p">):</span>
            <span class="k">if</span> <span class="p">(</span>
                <span class="n">is_parsing_page</span>
                <span class="ow">and</span> <span class="ow">not</span> <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">setup</span><span class="o">.</span><span class="n">is_tetml_page</span>
                <span class="ow">or</span> <span class="n">is_parsing_word</span>
                <span class="ow">and</span> <span class="ow">not</span> <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">setup</span><span class="o">.</span><span class="n">is_tetml_word</span>
            <span class="p">):</span>
                <span class="k">continue</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_document_parser_tetml_type</span><span class="p">(</span>
                <span class="n">full_name_in_parser</span><span class="p">,</span>
                <span class="n">full_name_in_tokenizer</span><span class="p">,</span>
                <span class="n">tetml_type</span><span class="p">,</span>
                <span class="n">is_parsing_line</span><span class="p">,</span>
                <span class="n">is_parsing_page</span><span class="p">,</span>
                <span class="n">is_parsing_word</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="k">if</span> <span class="n">is_parsing_line</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_no_lines_footer</span> <span class="o">=</span> <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">line_type_header_footer</span><span class="o">.</span><span class="n">no_lines_footer</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_no_lines_header</span> <span class="o">=</span> <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">line_type_header_footer</span><span class="o">.</span><span class="n">no_lines_header</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_no_lines_toc</span> <span class="o">=</span> <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">line_type_toc</span><span class="o">.</span><span class="n">no_lines_toc</span>

        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">LOGGER_END</span><span class="p">)</span>

    <span class="c1"># ------------------------------------------------------------------</span>
    <span class="c1"># Extract the text for a specific granularity from the PDF document.</span>
    <span class="c1"># ------------------------------------------------------------------</span>
    <span class="k">def</span> <span class="nf">_document_parser_tetml_type</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">full_name_in_parser</span><span class="p">,</span>
        <span class="n">full_name_in_tokenizer</span><span class="p">,</span>
        <span class="n">tetml_type</span><span class="p">,</span>
        <span class="n">is_parsing_line</span><span class="p">,</span>
        <span class="n">is_parsing_page</span><span class="p">,</span>
        <span class="n">is_parsing_word</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;XML Parser processing.</span>

<span class="sd">        Extract the text for a specific granularity from the PDF</span>
<span class="sd">        document.</span>

<span class="sd">        Raises:</span>
<span class="sd">            RuntimeError: Any parser issue.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">LOGGER_START</span><span class="p">)</span>

        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_is_verbose</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Start processing </span><span class="si">{</span><span class="n">tetml_type</span><span class="si">}</span><span class="s2">          </span><span class="si">{</span><span class="n">full_name_in_parser</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">setup</span><span class="o">.</span><span class="n">is_parsing_line</span> <span class="o">=</span> <span class="n">is_parsing_line</span>
        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">setup</span><span class="o">.</span><span class="n">is_parsing_page</span> <span class="o">=</span> <span class="n">is_parsing_page</span>
        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">setup</span><span class="o">.</span><span class="n">is_parsing_word</span> <span class="o">=</span> <span class="n">is_parsing_word</span>

        <span class="n">return_code</span><span class="p">,</span> <span class="n">error_msg</span> <span class="o">=</span> <span class="n">Process</span><span class="o">.</span><span class="n">parser</span><span class="p">(</span>
            <span class="n">full_name_in_parser</span><span class="p">,</span>
            <span class="n">full_name_in_tokenizer</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_no_pdf_pages</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_document_id</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_orig</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">return_code</span> <span class="o">!=</span> <span class="s2">&quot;ok&quot;</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="n">error_msg</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_document_delete_auxiliary_file</span><span class="p">(</span><span class="n">full_name_in_parser</span><span class="p">)</span>

        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_is_verbose</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;End   processing </span><span class="si">{</span><span class="n">tetml_type</span><span class="si">}</span><span class="s2">          </span><span class="si">{</span><span class="n">full_name_in_tokenizer</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">LOGGER_END</span><span class="p">)</span>

    <span class="c1"># ------------------------------------------------------------------</span>
    <span class="c1"># Convert the PDF document to an image file using pdf2image.</span>
    <span class="c1"># ------------------------------------------------------------------</span>
    <span class="k">def</span> <span class="nf">_document_pdf2image</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert the PDF document to an image file using pdf2image.</span>

<span class="sd">        Raises:</span>
<span class="sd">            RuntimeError: Any pdf2image issue.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_pdf2image</span><span class="p">:</span>
            <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">LOGGER_START</span><span class="p">)</span>

            <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_is_verbose</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Start processing pdf2image     </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_pdf2image</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_tesseract</span> <span class="o">=</span> <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_utils</span><span class="o">.</span><span class="n">get_full_name_from_components</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_directory</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_stem_name</span>
                <span class="o">+</span> <span class="s2">&quot;_[0-9]*.&quot;</span>
                <span class="o">+</span> <span class="p">(</span>
                    <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">FILE_TYPE_PNG</span>
                    <span class="k">if</span> <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">setup</span><span class="o">.</span><span class="n">pdf2image_type</span> <span class="o">==</span> <span class="n">dcr_core</span><span class="o">.</span><span class="n">cls_setup</span><span class="o">.</span><span class="n">Setup</span><span class="o">.</span><span class="n">PDF2IMAGE_TYPE_PNG</span>
                    <span class="k">else</span> <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">FILE_TYPE_JPEG</span>
                <span class="p">),</span>
            <span class="p">)</span>

            <span class="n">return_code</span><span class="p">,</span> <span class="n">error_msg</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">Process</span><span class="o">.</span><span class="n">pdf2image</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_pdf2image</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">return_code</span> <span class="o">!=</span> <span class="s2">&quot;ok&quot;</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="n">error_msg</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_document_delete_auxiliary_file</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_pdf2image</span><span class="p">)</span>

            <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_is_verbose</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;End   processing pdf2image     </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_tesseract</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">LOGGER_END</span><span class="p">)</span>

    <span class="c1"># ------------------------------------------------------------------</span>
    <span class="c1"># Extract the text and metadata from a PDF document to an XML file.</span>
    <span class="c1"># ------------------------------------------------------------------</span>
    <span class="k">def</span> <span class="nf">_document_pdflib</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Extract the text and metadata from a PDF document to an XML file.</span>

<span class="sd">        Raises:</span>
<span class="sd">            RuntimeError: Any PDFlib TET issue.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">LOGGER_START</span><span class="p">)</span>

        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_is_verbose</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Start processing PDFlib TET    </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_pdflib</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># noinspection PyUnresolvedReferences</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_no_pdf_pages</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">PyPDF2</span><span class="o">.</span><span class="n">PdfReader</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_pdflib</span><span class="p">)</span><span class="o">.</span><span class="n">pages</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_no_pdf_pages</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The number of pages of the PDF document </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_pdflib</span><span class="si">}</span><span class="s2"> cannot be determined&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_parser_line</span> <span class="o">=</span> <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_utils</span><span class="o">.</span><span class="n">get_full_name_from_components</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_directory</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_stem_name</span> <span class="o">+</span> <span class="s2">&quot;.&quot;</span> <span class="o">+</span> <span class="n">dcr_core</span><span class="o">.</span><span class="n">cls_nlp_core</span><span class="o">.</span><span class="n">NLPCore</span><span class="o">.</span><span class="n">LINE_XML_VARIATION</span> <span class="o">+</span> <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">FILE_TYPE_XML</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">return_code</span><span class="p">,</span> <span class="n">error_msg</span> <span class="o">=</span> <span class="n">Process</span><span class="o">.</span><span class="n">pdflib</span><span class="p">(</span>
            <span class="n">full_name_in</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_pdflib</span><span class="p">,</span>
            <span class="n">full_name_out</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_parser_line</span><span class="p">,</span>
            <span class="n">document_opt_list</span><span class="o">=</span><span class="n">dcr_core</span><span class="o">.</span><span class="n">cls_nlp_core</span><span class="o">.</span><span class="n">NLPCore</span><span class="o">.</span><span class="n">LINE_TET_DOCUMENT_OPT_LIST</span><span class="p">,</span>
            <span class="n">page_opt_list</span><span class="o">=</span><span class="n">dcr_core</span><span class="o">.</span><span class="n">cls_nlp_core</span><span class="o">.</span><span class="n">NLPCore</span><span class="o">.</span><span class="n">LINE_TET_PAGE_OPT_LIST</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">return_code</span> <span class="o">!=</span> <span class="s2">&quot;ok&quot;</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="n">error_msg</span><span class="p">)</span>

        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_is_verbose</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;End   processing PDFlib TET    </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_parser_line</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">setup</span><span class="o">.</span><span class="n">is_tetml_page</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_parser_page</span> <span class="o">=</span> <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_utils</span><span class="o">.</span><span class="n">get_full_name_from_components</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_directory</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_stem_name</span> <span class="o">+</span> <span class="s2">&quot;.&quot;</span> <span class="o">+</span> <span class="n">dcr_core</span><span class="o">.</span><span class="n">cls_nlp_core</span><span class="o">.</span><span class="n">NLPCore</span><span class="o">.</span><span class="n">PAGE_XML_VARIATION</span> <span class="o">+</span> <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">FILE_TYPE_XML</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">return_code</span><span class="p">,</span> <span class="n">error_msg</span> <span class="o">=</span> <span class="n">Process</span><span class="o">.</span><span class="n">pdflib</span><span class="p">(</span>
                <span class="n">full_name_in</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_pdflib</span><span class="p">,</span>
                <span class="n">full_name_out</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_parser_page</span><span class="p">,</span>
                <span class="n">document_opt_list</span><span class="o">=</span><span class="n">dcr_core</span><span class="o">.</span><span class="n">cls_nlp_core</span><span class="o">.</span><span class="n">NLPCore</span><span class="o">.</span><span class="n">PAGE_TET_DOCUMENT_OPT_LIST</span><span class="p">,</span>
                <span class="n">page_opt_list</span><span class="o">=</span><span class="n">dcr_core</span><span class="o">.</span><span class="n">cls_nlp_core</span><span class="o">.</span><span class="n">NLPCore</span><span class="o">.</span><span class="n">PAGE_TET_PAGE_OPT_LIST</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">return_code</span> <span class="o">!=</span> <span class="s2">&quot;ok&quot;</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="n">error_msg</span><span class="p">)</span>
            <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_is_verbose</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;End   processing PDFlib TET    </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_parser_page</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">setup</span><span class="o">.</span><span class="n">is_tetml_word</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_parser_word</span> <span class="o">=</span> <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_utils</span><span class="o">.</span><span class="n">get_full_name_from_components</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_directory</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_stem_name</span> <span class="o">+</span> <span class="s2">&quot;.&quot;</span> <span class="o">+</span> <span class="n">dcr_core</span><span class="o">.</span><span class="n">cls_nlp_core</span><span class="o">.</span><span class="n">NLPCore</span><span class="o">.</span><span class="n">WORD_XML_VARIATION</span> <span class="o">+</span> <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">FILE_TYPE_XML</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">return_code</span><span class="p">,</span> <span class="n">error_msg</span> <span class="o">=</span> <span class="n">Process</span><span class="o">.</span><span class="n">pdflib</span><span class="p">(</span>
                <span class="n">full_name_in</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_pdflib</span><span class="p">,</span>
                <span class="n">full_name_out</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_parser_word</span><span class="p">,</span>
                <span class="n">document_opt_list</span><span class="o">=</span><span class="n">dcr_core</span><span class="o">.</span><span class="n">cls_nlp_core</span><span class="o">.</span><span class="n">NLPCore</span><span class="o">.</span><span class="n">WORD_TET_DOCUMENT_OPT_LIST</span><span class="p">,</span>
                <span class="n">page_opt_list</span><span class="o">=</span><span class="n">dcr_core</span><span class="o">.</span><span class="n">cls_nlp_core</span><span class="o">.</span><span class="n">NLPCore</span><span class="o">.</span><span class="n">WORD_TET_PAGE_OPT_LIST</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">return_code</span> <span class="o">!=</span> <span class="s2">&quot;ok&quot;</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="n">error_msg</span><span class="p">)</span>
            <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_is_verbose</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;End   processing PDFlib TET    </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_parser_word</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_document_delete_auxiliary_file</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_pdflib</span><span class="p">)</span>

        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">LOGGER_END</span><span class="p">)</span>

    <span class="c1"># ------------------------------------------------------------------</span>
    <span class="c1"># Convert one or more image files to a PDF file using Tesseract OCR.</span>
    <span class="c1"># ------------------------------------------------------------------</span>
    <span class="k">def</span> <span class="nf">_document_tesseract</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Process the document with Tesseract OCR.</span>

<span class="sd">        Convert one or more image files to a PDF file using Tesseract</span>
<span class="sd">        OCR.</span>

<span class="sd">        Raises:</span>
<span class="sd">            RuntimeError: Any Tesseract OCR issue.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_tesseract</span><span class="p">:</span>
            <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">LOGGER_START</span><span class="p">)</span>

            <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_is_verbose</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Start processing Tesseract OCR </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_tesseract</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_pdf2image</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_stem_name</span> <span class="o">+=</span> <span class="s2">&quot;_0&quot;</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_pdflib</span> <span class="o">=</span> <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_utils</span><span class="o">.</span><span class="n">get_full_name_from_components</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_directory</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_stem_name</span><span class="p">,</span> <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">FILE_TYPE_PDF</span>
            <span class="p">)</span>

            <span class="n">return_code</span><span class="p">,</span> <span class="n">error_msg</span><span class="p">,</span> <span class="n">children</span> <span class="o">=</span> <span class="n">Process</span><span class="o">.</span><span class="n">tesseract</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_tesseract</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_pdflib</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_language_tesseract</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">return_code</span> <span class="o">!=</span> <span class="s2">&quot;ok&quot;</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="n">error_msg</span><span class="p">)</span>

            <span class="c1"># noinspection PyUnresolvedReferences</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_no_pdf_pages</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">PyPDF2</span><span class="o">.</span><span class="n">PdfReader</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_pdflib</span><span class="p">)</span><span class="o">.</span><span class="n">pages</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_no_pdf_pages</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The number of pages of the PDF document </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_pdflib</span><span class="si">}</span><span class="s2"> cannot be determined&quot;</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">children</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_document_delete_auxiliary_file</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>

            <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_is_verbose</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;End   processing Tesseract OCR </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_pdflib</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">LOGGER_END</span><span class="p">)</span>

    <span class="c1"># ------------------------------------------------------------------</span>
    <span class="c1"># Convert the PDF document to an image file using pdf2image.</span>
    <span class="c1"># ------------------------------------------------------------------</span>
    <span class="k">def</span> <span class="nf">_document_tokenizer</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Tokenize the document with spaCy.</span>

<span class="sd">        Raises:</span>
<span class="sd">            RuntimeError: Any spaCy issue.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">LOGGER_START</span><span class="p">)</span>

        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_is_verbose</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Start processing spaCy         </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_tokenizer_line</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">tokenizer_spacy</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">tokenizer_spacy</span> <span class="o">=</span> <span class="n">dcr_core</span><span class="o">.</span><span class="n">cls_tokenizer_spacy</span><span class="o">.</span><span class="n">TokenizerSpacy</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_next_step</span> <span class="o">=</span> <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_utils</span><span class="o">.</span><span class="n">get_full_name_from_components</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_directory</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_stem_name</span> <span class="o">+</span> <span class="s2">&quot;.line_token.&quot;</span> <span class="o">+</span> <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">FILE_TYPE_JSON</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">return_code</span><span class="p">,</span> <span class="n">error_msg</span> <span class="o">=</span> <span class="n">Process</span><span class="o">.</span><span class="n">tokenizer</span><span class="p">(</span>
            <span class="n">full_name_in</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_tokenizer_line</span><span class="p">,</span>
            <span class="n">full_name_out</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_next_step</span><span class="p">,</span>
            <span class="n">pipeline_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_language_spacy</span><span class="p">,</span>
            <span class="n">document_id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_document_id</span><span class="p">,</span>
            <span class="n">full_name_orig</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_full_name_orig</span><span class="p">,</span>
            <span class="n">no_lines_footer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_no_lines_footer</span><span class="p">,</span>
            <span class="n">no_lines_header</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_no_lines_header</span><span class="p">,</span>
            <span class="n">no_lines_toc</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_no_lines_toc</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">return_code</span> <span class="o">!=</span> <span class="s2">&quot;ok&quot;</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="n">error_msg</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_document_delete_auxiliary_file</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_tokenizer_line</span><span class="p">)</span>

        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_is_verbose</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;End   processing spaCy         </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_next_step</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">LOGGER_END</span><span class="p">)</span>

    <span class="c1"># ------------------------------------------------------------------</span>
    <span class="c1"># Document content recognition for a specific file.</span>
    <span class="c1"># ------------------------------------------------------------------</span>
    <span class="k">def</span> <span class="nf">document</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">full_name_in</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">document_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">full_name_orig</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">is_delete_auxiliary_files</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">is_verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">language_pandoc</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">language_spacy</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">language_tesseract</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">output_directory</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Document content recognition for a specific file.</span>

<span class="sd">        This method extracts the document content structure from a</span>
<span class="sd">        given document and stores it in JSON format. For this purpose,</span>
<span class="sd">        all non-pdf documents and all scanned pdf documents are first</span>
<span class="sd">        converted into a searchable pdf format. Depending on the file</span>
<span class="sd">        format, the tools Pandoc, pdf2image or Tesseract OCR are used</span>
<span class="sd">        for this purpose. PDFlib TET then extracts the text and metadata</span>
<span class="sd">        from the searchable pdf file and makes them available in XML format.</span>
<span class="sd">        spaCY generates qualified tokens from the document text, and these</span>
<span class="sd">        token data are then made available together with the metadata in a</span>
<span class="sd">        JSON format.</span>

<span class="sd">        Args:</span>
<span class="sd">            full_name_in (str):</span>
<span class="sd">                Full file name of the document file.</span>
<span class="sd">            document_id (int, optional):</span>
<span class="sd">                Document identification.</span>
<span class="sd">                Defaults to -1 i.e. no document identification.</span>
<span class="sd">            full_name_orig (str, optional):</span>
<span class="sd">                Original full file name.</span>
<span class="sd">                Defaults to the full file name of the document file.</span>
<span class="sd">            is_delete_auxiliary_files (bool, optional):</span>
<span class="sd">                Delete the auxiliary files after a successful processing step.</span>
<span class="sd">                Defaults to parameter `delete_auxiliary_files` in `setup.cfg`.</span>
<span class="sd">            is_verbose (bool, optional):</span>
<span class="sd">                Display progress messages for processing.</span>
<span class="sd">                Defaults to parameter `verbose` in `setup.cfg`.</span>
<span class="sd">            language_pandoc (str, optional):</span>
<span class="sd">                Pandoc language code.</span>
<span class="sd">                Defaults to English.</span>
<span class="sd">            language_spacy (str, optional):</span>
<span class="sd">                spaCy language code.</span>
<span class="sd">                Defaults to English transformer pipeline (roberta-base)..</span>
<span class="sd">            language_tesseract (str, optional):</span>
<span class="sd">                Tesseract OCR language code.</span>
<span class="sd">                Defaults to English.</span>
<span class="sd">            output_directory (str, optional):</span>
<span class="sd">                Directory for the flat files to be created.</span>
<span class="sd">                Defaults to the directory of the document file.</span>

<span class="sd">        Raises:</span>
<span class="sd">            RuntimeError: Any issue from Pandoc, pdf2image, PDFlib TET, spaCy, or Tesseract OCR.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Initialise the logging functionality.</span>
        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">initialise_logger</span><span class="p">()</span>

        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">LOGGER_START</span><span class="p">)</span>

        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;param full_name_in=</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">full_name_in</span><span class="p">)</span>
        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;param document_id =</span><span class="si">%i</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">document_id</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_document_init</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_document_id</span> <span class="o">=</span> <span class="n">document_id</span> <span class="k">if</span> <span class="n">document_id</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in</span> <span class="o">=</span> <span class="n">full_name_in</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_orig</span> <span class="o">=</span> <span class="n">full_name_orig</span> <span class="k">if</span> <span class="n">full_name_orig</span> <span class="k">else</span> <span class="n">full_name_in</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_language_pandoc</span> <span class="o">=</span> <span class="n">language_pandoc</span> <span class="k">if</span> <span class="n">language_pandoc</span> <span class="k">else</span> <span class="n">dcr_core</span><span class="o">.</span><span class="n">cls_nlp_core</span><span class="o">.</span><span class="n">NLPCore</span><span class="o">.</span><span class="n">LANGUAGE_PANDOC_DEFAULT</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_language_spacy</span> <span class="o">=</span> <span class="n">language_spacy</span> <span class="k">if</span> <span class="n">language_spacy</span> <span class="k">else</span> <span class="n">dcr_core</span><span class="o">.</span><span class="n">cls_nlp_core</span><span class="o">.</span><span class="n">NLPCore</span><span class="o">.</span><span class="n">LANGUAGE_SPACY_DEFAULT</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_language_tesseract</span> <span class="o">=</span> <span class="n">language_tesseract</span> <span class="k">if</span> <span class="n">language_tesseract</span> <span class="k">else</span> <span class="n">dcr_core</span><span class="o">.</span><span class="n">cls_nlp_core</span><span class="o">.</span><span class="n">NLPCore</span><span class="o">.</span><span class="n">LANGUAGE_TESSERACT_DEFAULT</span>

        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;param full_name_orig    =</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_orig</span><span class="p">)</span>
        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;param language_pandoc   =</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_language_pandoc</span><span class="p">)</span>
        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;param language_spacy    =</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_language_spacy</span><span class="p">)</span>
        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;param language_tesseract=</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_language_tesseract</span><span class="p">)</span>

        <span class="c1"># Load the configuration parameters.</span>
        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">setup</span> <span class="o">=</span> <span class="n">dcr_core</span><span class="o">.</span><span class="n">cls_setup</span><span class="o">.</span><span class="n">Setup</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_is_delete_auxiliary_files</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">is_delete_auxiliary_files</span> <span class="k">if</span> <span class="n">is_delete_auxiliary_files</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">setup</span><span class="o">.</span><span class="n">is_delete_auxiliary_files</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_verbose</span> <span class="o">=</span> <span class="n">is_verbose</span> <span class="k">if</span> <span class="n">is_verbose</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">setup</span><span class="o">.</span><span class="n">is_verbose</span>

        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_is_verbose</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Start processing document file </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_full_name_orig</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_is_verbose</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Language key Pandoc            </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_language_pandoc</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_is_verbose</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Language key spaCy             </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_language_spacy</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_is_verbose</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Language key Tesseract OCR     </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_language_tesseract</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="p">(</span>
            <span class="n">full_name_in_directory</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_stem_name</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_extension</span><span class="p">,</span>
        <span class="p">)</span> <span class="o">=</span> <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_utils</span><span class="o">.</span><span class="n">get_components_from_full_name</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_directory</span> <span class="o">=</span> <span class="n">output_directory</span> <span class="k">if</span> <span class="n">output_directory</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">full_name_in_directory</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_extension_int</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_extension</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_extension</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_extension</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_document_check_extension</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_document_pandoc</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_document_pdf2image</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_document_tesseract</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_document_pdflib</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_document_parser</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_document_tokenizer</span><span class="p">()</span>

        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_is_verbose</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;End   processing document file </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_full_name_orig</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">LOGGER_END</span><span class="p">)</span>

    <span class="c1"># ------------------------------------------------------------------</span>
    <span class="c1"># Converting a Non-PDF file to a PDF file.</span>
    <span class="c1"># ------------------------------------------------------------------</span>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">pandoc</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">full_name_in</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">full_name_out</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">language_pandoc</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert a Non-PDF file to a PDF file.</span>

<span class="sd">        The following file formats are converted into</span>
<span class="sd">        PDF format here with the help of Pandoc:</span>

<span class="sd">        - csv - comma-separated values</span>
<span class="sd">        - docx - Office Open XML</span>
<span class="sd">        - epub - e-book file format</span>
<span class="sd">        - html - HyperText Markup Language</span>
<span class="sd">        - odt - Open Document Format for Office Applications</span>
<span class="sd">        - rst - reStructuredText (RST</span>
<span class="sd">        - rtf - Rich Text Format</span>

<span class="sd">        Args:</span>
<span class="sd">            full_name_in (str):</span>
<span class="sd">                    The directory name and file name of the input file.</span>
<span class="sd">            full_name_out (str):</span>
<span class="sd">                    The directory name and file name of the output file.</span>
<span class="sd">            language_pandoc (str):</span>
<span class="sd">                    The Pandoc name of the document language.</span>

<span class="sd">        Returns:</span>
<span class="sd">            tuple[str, str]:</span>
<span class="sd">                    (&quot;ok&quot;, &quot;&quot;) if the processing has been completed successfully,</span>
<span class="sd">                               otherwise a corresponding error code and error message.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">LOGGER_START</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">initialise_logger</span><span class="p">()</span>
            <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">LOGGER_START</span><span class="p">)</span>

        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;param full_name_in   =</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">full_name_in</span><span class="p">)</span>
        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;param full_name_out  =</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">full_name_out</span><span class="p">)</span>
        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;param language_pandoc=</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">language_pandoc</span><span class="p">)</span>

        <span class="c1"># Convert the document</span>
        <span class="n">extra_args</span> <span class="o">=</span> <span class="p">[</span>
            <span class="sa">f</span><span class="s2">&quot;--pdf-engine=</span><span class="si">{</span><span class="n">Process</span><span class="o">.</span><span class="n">PANDOC_PDF_ENGINE_XELATEX</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="s2">&quot;-V&quot;</span><span class="p">,</span>
            <span class="sa">f</span><span class="s2">&quot;lang:</span><span class="si">{</span><span class="n">language_pandoc</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="p">]</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">pypandoc</span><span class="o">.</span><span class="n">convert_file</span><span class="p">(</span>
                <span class="n">full_name_in</span><span class="p">,</span>
                <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">FILE_TYPE_PDF</span><span class="p">,</span>
                <span class="n">extra_args</span><span class="o">=</span><span class="n">extra_args</span><span class="p">,</span>
                <span class="n">outputfile</span><span class="o">=</span><span class="n">full_name_out</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">PyPDF2</span><span class="o">.</span><span class="n">PdfReader</span><span class="p">(</span><span class="n">full_name_out</span><span class="p">)</span><span class="o">.</span><span class="n">pages</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">error_msg</span> <span class="o">=</span> <span class="n">Process</span><span class="o">.</span><span class="n">ERROR_31_911</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{full_name}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">full_name_out</span><span class="p">)</span>
                <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;return               =</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">error_msg</span><span class="p">[:</span><span class="mi">6</span><span class="p">],</span> <span class="n">error_msg</span><span class="p">))</span>
                <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">LOGGER_END</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">error_msg</span><span class="p">[:</span><span class="mi">6</span><span class="p">],</span> <span class="n">error_msg</span>

        <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
            <span class="n">error_msg</span> <span class="o">=</span> <span class="n">Process</span><span class="o">.</span><span class="n">ERROR_31_902</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{full_name}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">full_name_in</span><span class="p">)</span>
            <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;return               =</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">error_msg</span><span class="p">[:</span><span class="mi">6</span><span class="p">],</span> <span class="n">error_msg</span><span class="p">))</span>
            <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">LOGGER_END</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">error_msg</span><span class="p">[:</span><span class="mi">6</span><span class="p">],</span> <span class="n">error_msg</span>
        <span class="k">except</span> <span class="ne">RuntimeError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">error_msg</span> <span class="o">=</span> <span class="n">Process</span><span class="o">.</span><span class="n">ERROR_31_903</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{full_name}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">full_name_in</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{error_msg}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
            <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;return               =</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">error_msg</span><span class="p">[:</span><span class="mi">6</span><span class="p">],</span> <span class="n">error_msg</span><span class="p">))</span>
            <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">LOGGER_END</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">error_msg</span><span class="p">[:</span><span class="mi">6</span><span class="p">],</span> <span class="n">error_msg</span>

        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;return               =</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">RETURN_OK</span><span class="p">)</span>
        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">LOGGER_END</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">RETURN_OK</span>

    <span class="c1"># ------------------------------------------------------------------</span>
    <span class="c1"># Extracting the text from the PDF document.</span>
    <span class="c1"># ------------------------------------------------------------------</span>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">parser</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">full_name_in</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">full_name_out</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">no_pdf_pages</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">document_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">full_name_orig</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">INFORMATION_NOT_YET_AVAILABLE</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Extract the text from the PDF document.</span>

<span class="sd">        From the line-oriented XML output file of PDFlib TET,</span>
<span class="sd">        the text and relevant metadata are extracted with the</span>
<span class="sd">        help of an XML parser and stored in a JSON file.</span>

<span class="sd">        Args:</span>
<span class="sd">            full_name_in (str):</span>
<span class="sd">                    The directory name and file name of the input file.</span>
<span class="sd">            full_name_out (str):</span>
<span class="sd">                    The directory name and file name of the output file.</span>
<span class="sd">            no_pdf_pages (int):</span>
<span class="sd">                    Total number of PDF pages.</span>
<span class="sd">            document_id (int, optional):</span>
<span class="sd">                    The identification number of the document.</span>
<span class="sd">                    Defaults to -1.</span>
<span class="sd">            full_name_orig (str, optional):</span>
<span class="sd">                    The file name of the originating document.</span>
<span class="sd">                    Defaults to dcr_core.core_glob.INFORMATION_NOT_YET_AVAILABLE.</span>

<span class="sd">        Returns:</span>
<span class="sd">            tuple[str, str]:</span>
<span class="sd">                    (&quot;ok&quot;, &quot;&quot;) if the processing has been completed successfully,</span>
<span class="sd">                               otherwise a corresponding error code and error message.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">LOGGER_START</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">initialise_logger</span><span class="p">()</span>
            <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">LOGGER_START</span><span class="p">)</span>

        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;param document_id   =</span><span class="si">%i</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">document_id</span><span class="p">)</span>
        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;param full_name_orig=</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">full_name_orig</span><span class="p">)</span>
        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;param full_name_in  =</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">full_name_in</span><span class="p">)</span>
        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;param full_name_out =</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">full_name_out</span><span class="p">)</span>
        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;param no_pdf_pages  =</span><span class="si">%i</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">no_pdf_pages</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Create the Element tree object</span>
            <span class="n">tree</span> <span class="o">=</span> <span class="n">defusedxml</span><span class="o">.</span><span class="n">ElementTree</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">full_name_in</span><span class="p">)</span>

            <span class="c1"># Get the root Element</span>
            <span class="n">root</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">getroot</span><span class="p">()</span>

            <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">text_parser</span> <span class="o">=</span> <span class="n">dcr_core</span><span class="o">.</span><span class="n">cls_text_parser</span><span class="o">.</span><span class="n">TextParser</span><span class="p">()</span>

            <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">root</span><span class="p">:</span>
                <span class="n">child_tag</span> <span class="o">=</span> <span class="n">child</span><span class="o">.</span><span class="n">tag</span><span class="p">[</span><span class="n">dcr_core</span><span class="o">.</span><span class="n">cls_nlp_core</span><span class="o">.</span><span class="n">NLPCore</span><span class="o">.</span><span class="n">PARSE_ELEM_FROM</span> <span class="p">:]</span>
                <span class="k">match</span> <span class="n">child_tag</span><span class="p">:</span>
                    <span class="k">case</span> <span class="n">dcr_core</span><span class="o">.</span><span class="n">cls_nlp_core</span><span class="o">.</span><span class="n">NLPCore</span><span class="o">.</span><span class="n">PARSE_ELEM_DOCUMENT</span><span class="p">:</span>
                        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">text_parser</span><span class="o">.</span><span class="n">parse_tag_document</span><span class="p">(</span>
                            <span class="n">directory_name</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">full_name_in</span><span class="p">),</span>
                            <span class="n">document_id</span><span class="o">=</span><span class="n">document_id</span><span class="p">,</span>
                            <span class="n">environment_variant</span><span class="o">=</span><span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">setup</span><span class="o">.</span><span class="n">environment_variant</span><span class="p">,</span>
                            <span class="n">file_name_curr</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">full_name_in</span><span class="p">),</span>
                            <span class="n">file_name_next</span><span class="o">=</span><span class="n">full_name_out</span><span class="p">,</span>
                            <span class="n">file_name_orig</span><span class="o">=</span><span class="n">full_name_orig</span><span class="p">,</span>
                            <span class="n">no_pdf_pages</span><span class="o">=</span><span class="n">no_pdf_pages</span><span class="p">,</span>
                            <span class="n">parent</span><span class="o">=</span><span class="n">child</span><span class="p">,</span>
                            <span class="n">parent_tag</span><span class="o">=</span><span class="n">child_tag</span><span class="p">,</span>
                        <span class="p">)</span>
                    <span class="k">case</span> <span class="n">dcr_core</span><span class="o">.</span><span class="n">cls_nlp_core</span><span class="o">.</span><span class="n">NLPCore</span><span class="o">.</span><span class="n">PARSE_ELEM_CREATION</span><span class="p">:</span>
                        <span class="k">pass</span>
        <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
            <span class="n">error_msg</span> <span class="o">=</span> <span class="n">Process</span><span class="o">.</span><span class="n">ERROR_61_901</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{full_name}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">full_name_in</span><span class="p">)</span>
            <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;return              =</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">error_msg</span><span class="p">[:</span><span class="mi">6</span><span class="p">],</span> <span class="n">error_msg</span><span class="p">))</span>
            <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">LOGGER_END</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">error_msg</span><span class="p">[:</span><span class="mi">6</span><span class="p">],</span> <span class="n">error_msg</span>

        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;return              =</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">RETURN_OK</span><span class="p">)</span>
        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">LOGGER_END</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">RETURN_OK</span>

    <span class="c1"># ------------------------------------------------------------------</span>
    <span class="c1"># Converting a scanned PDF file to a set of image files.</span>
    <span class="c1"># ------------------------------------------------------------------</span>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">pdf2image</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">full_name_in</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert a scanned PDF file to a set of image files.</span>

<span class="sd">        To extract the text from a scanned PDF document, it must</span>
<span class="sd">        first be converted into one or more image files, depending</span>
<span class="sd">        on the number of pages. Then these image files are converted</span>
<span class="sd">        into a normal PDF document with the help of an OCR programme.</span>
<span class="sd">        The input file for this method must be a scanned PDF document,</span>
<span class="sd">        which is then converted into image files with the help of PDF2Image.</span>

<span class="sd">        Args:</span>
<span class="sd">            full_name_in (str):</span>
<span class="sd">                    The directory name and file name of the input file.</span>

<span class="sd">        Returns:</span>
<span class="sd">            tuple[str, str, list[tuple[str,str]]]:</span>
<span class="sd">                    (&quot;ok&quot;, &quot;&quot;, [...]) if the processing has been completed successfully,</span>
<span class="sd">                                      otherwise a corresponding error code and error message.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">LOGGER_START</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">initialise_logger</span><span class="p">()</span>
            <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">LOGGER_START</span><span class="p">)</span>

        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;param full_name_in=</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">full_name_in</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">images</span> <span class="o">=</span> <span class="n">pdf2image</span><span class="o">.</span><span class="n">convert_from_path</span><span class="p">(</span><span class="n">full_name_in</span><span class="p">)</span>

            <span class="n">children</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">no_children</span> <span class="o">=</span> <span class="mi">0</span>

            <span class="n">directory_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">full_name_in</span><span class="p">)</span>
            <span class="n">stem_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">full_name_in</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span>
                    <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_utils</span><span class="o">.</span><span class="n">get_full_name_from_components</span><span class="p">(</span>
                        <span class="n">directory_name</span><span class="p">,</span>
                        <span class="n">stem_name</span>
                        <span class="o">+</span> <span class="s2">&quot;_*.&quot;</span>
                        <span class="o">+</span> <span class="p">(</span>
                            <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">FILE_TYPE_PNG</span>
                            <span class="k">if</span> <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">setup</span><span class="o">.</span><span class="n">pdf2image_type</span> <span class="o">==</span> <span class="n">dcr_core</span><span class="o">.</span><span class="n">cls_setup</span><span class="o">.</span><span class="n">Setup</span><span class="o">.</span><span class="n">PDF2IMAGE_TYPE_PNG</span>
                            <span class="k">else</span> <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">FILE_TYPE_JPEG</span>
                        <span class="p">),</span>
                    <span class="p">)</span>
                <span class="p">)</span>
            <span class="k">except</span> <span class="ne">OSError</span><span class="p">:</span>
                <span class="k">pass</span>

            <span class="c1"># Store the image pages</span>
            <span class="k">for</span> <span class="n">img</span> <span class="ow">in</span> <span class="n">images</span><span class="p">:</span>
                <span class="n">no_children</span> <span class="o">+=</span> <span class="mi">1</span>

                <span class="n">file_name_next</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">stem_name</span>
                    <span class="o">+</span> <span class="s2">&quot;_&quot;</span>
                    <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">no_children</span><span class="p">)</span>
                    <span class="o">+</span> <span class="s2">&quot;.&quot;</span>
                    <span class="o">+</span> <span class="p">(</span>
                        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">FILE_TYPE_PNG</span>
                        <span class="k">if</span> <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">setup</span><span class="o">.</span><span class="n">pdf2image_type</span> <span class="o">==</span> <span class="n">dcr_core</span><span class="o">.</span><span class="n">cls_setup</span><span class="o">.</span><span class="n">Setup</span><span class="o">.</span><span class="n">PDF2IMAGE_TYPE_PNG</span>
                        <span class="k">else</span> <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">FILE_TYPE_JPEG</span>
                    <span class="p">)</span>
                <span class="p">)</span>

                <span class="n">full_name_next</span> <span class="o">=</span> <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_utils</span><span class="o">.</span><span class="n">get_full_name_from_components</span><span class="p">(</span>
                    <span class="n">directory_name</span><span class="p">,</span>
                    <span class="n">file_name_next</span><span class="p">,</span>
                <span class="p">)</span>

                <span class="n">img</span><span class="o">.</span><span class="n">save</span><span class="p">(</span>
                    <span class="n">full_name_next</span><span class="p">,</span>
                    <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">setup</span><span class="o">.</span><span class="n">pdf2image_type</span><span class="p">,</span>
                <span class="p">)</span>

                <span class="n">children</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">file_name_next</span><span class="p">,</span> <span class="n">full_name_next</span><span class="p">))</span>
        <span class="k">except</span> <span class="n">PDFPageCountError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">error_msg</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">Process</span><span class="o">.</span><span class="n">ERROR_21_901</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{full_name}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">full_name_in</span><span class="p">)</span>
                <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{error_type}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">err</span><span class="p">)))</span>
                <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{error_msg}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
            <span class="p">)</span>
            <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;return            =</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">error_msg</span><span class="p">[:</span><span class="mi">6</span><span class="p">],</span> <span class="n">error_msg</span><span class="p">,</span> <span class="p">[]))</span>
            <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">LOGGER_END</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">error_msg</span><span class="p">[:</span><span class="mi">6</span><span class="p">],</span> <span class="n">error_msg</span><span class="p">,</span> <span class="p">[]</span>

        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="s2">&quot;return            =</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">RETURN_OK</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">RETURN_OK</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">children</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">LOGGER_END</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">RETURN_OK</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">RETURN_OK</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">children</span>

    <span class="c1"># ------------------------------------------------------------------</span>
    <span class="c1"># Processing a PDF file with PDFlib TET.</span>
    <span class="c1"># ------------------------------------------------------------------</span>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">pdflib</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">full_name_in</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">full_name_out</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">document_opt_list</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">page_opt_list</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Process a PDF file with PDFlib TET.</span>

<span class="sd">        The data from a PDF file is made available in XML files</span>
<span class="sd">        with the help of PDFlib TET. The granularity of the XML</span>
<span class="sd">        files can be word, line or paragraph depending on the</span>
<span class="sd">        document and page options selected.</span>

<span class="sd">        Args:</span>
<span class="sd">            full_name_in (str):</span>
<span class="sd">                    Directory name and file name of the input file.</span>
<span class="sd">            full_name_out (str):</span>
<span class="sd">                    Directory name and file name of the output file.</span>
<span class="sd">            document_opt_list (str):</span>
<span class="sd">                    Document level options:</span>
<span class="sd">                        word: engines={noannotation noimage text notextcolor novector}</span>
<span class="sd">                        line: engines={noannotation noimage text notextcolor novector}</span>
<span class="sd">                        page: engines={noannotation noimage text notextcolor novector} lineseparator=U+0020</span>
<span class="sd">            page_opt_list (str):</span>
<span class="sd">                    Page level options:</span>
<span class="sd">                        word: granularity=word tetml={elements={line}}</span>
<span class="sd">                        line: granularity=line</span>
<span class="sd">                        page: granularity=page</span>

<span class="sd">        Returns:</span>
<span class="sd">            tuple[str, str]:</span>
<span class="sd">                    (&quot;ok&quot;, &quot;&quot;) if the processing has been completed successfully,</span>
<span class="sd">                               otherwise a corresponding error code and error message.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">LOGGER_START</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">initialise_logger</span><span class="p">()</span>
            <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">LOGGER_START</span><span class="p">)</span>

        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;param full_name_in     =</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">full_name_in</span><span class="p">)</span>
        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;param full_name_out    =</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">full_name_out</span><span class="p">)</span>
        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;param document_opt_list=</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">document_opt_list</span><span class="p">)</span>
        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;param page_opt_list    =</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">page_opt_list</span><span class="p">)</span>

        <span class="n">tet</span> <span class="o">=</span> <span class="n">dcr_core</span><span class="o">.</span><span class="n">PDFlib</span><span class="o">.</span><span class="n">TET</span><span class="o">.</span><span class="n">TET</span><span class="p">()</span>

        <span class="n">doc_opt_list</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;tetml=</span><span class="se">{{</span><span class="s2">filename=</span><span class="se">{{</span><span class="si">{</span><span class="n">full_name_out</span><span class="si">}</span><span class="se">}}}}</span><span class="s2"> </span><span class="si">{</span><span class="n">document_opt_list</span><span class="si">}</span><span class="s2">&quot;</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">file_curr</span> <span class="o">:=</span> <span class="n">tet</span><span class="o">.</span><span class="n">open_document</span><span class="p">(</span><span class="n">full_name_in</span><span class="p">,</span> <span class="n">doc_opt_list</span><span class="p">))</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">error_msg</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">Process</span><span class="o">.</span><span class="n">ERROR_51_901</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{full_name}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">full_name_in</span><span class="p">)</span>
                <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{error_no}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">tet</span><span class="o">.</span><span class="n">get_errnum</span><span class="p">()))</span>
                <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{api_name}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">tet</span><span class="o">.</span><span class="n">get_apiname</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;()&quot;</span><span class="p">)</span>
                <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{error_msg}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">tet</span><span class="o">.</span><span class="n">get_errmsg</span><span class="p">())</span>
            <span class="p">)</span>
            <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;return                 =</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">error_msg</span><span class="p">[:</span><span class="mi">6</span><span class="p">],</span> <span class="n">error_msg</span><span class="p">))</span>
            <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">LOGGER_END</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">error_msg</span><span class="p">[:</span><span class="mi">6</span><span class="p">],</span> <span class="n">error_msg</span>

        <span class="c1"># get number of pages in the document */</span>
        <span class="n">no_pages</span> <span class="o">=</span> <span class="n">tet</span><span class="o">.</span><span class="n">pcos_get_number</span><span class="p">(</span><span class="n">file_curr</span><span class="p">,</span> <span class="s2">&quot;length:pages&quot;</span><span class="p">)</span>

        <span class="c1"># loop over pages in the document */</span>
        <span class="k">for</span> <span class="n">page_no</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">no_pages</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">tet</span><span class="o">.</span><span class="n">process_page</span><span class="p">(</span><span class="n">file_curr</span><span class="p">,</span> <span class="n">page_no</span><span class="p">,</span> <span class="n">page_opt_list</span><span class="p">)</span>

        <span class="c1"># This could be combined with the last page-related call</span>
        <span class="n">tet</span><span class="o">.</span><span class="n">process_page</span><span class="p">(</span><span class="n">file_curr</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;tetml=</span><span class="si">{trailer}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">tet</span><span class="o">.</span><span class="n">close_document</span><span class="p">(</span><span class="n">file_curr</span><span class="p">)</span>

        <span class="n">tet</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>

        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;return                 =</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">LOGGER_END</span><span class="p">)</span>
        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">LOGGER_END</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">RETURN_OK</span>

    <span class="c1"># ------------------------------------------------------------------</span>
    <span class="c1"># Converting image files to PDF files via OCR.</span>
    <span class="c1"># ------------------------------------------------------------------</span>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">tesseract</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">full_name_in</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">full_name_out</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">language_tesseract</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert image files to PDF files via OCR.</span>

<span class="sd">        The documents of the following document types are converted</span>
<span class="sd">        to the PDF format using Tesseract OCR:</span>

<span class="sd">        - bmp - bitmap image file</span>
<span class="sd">        - gif - Graphics Interchange Format</span>
<span class="sd">        - jp2 - JPEG 2000</span>
<span class="sd">        - jpeg - Joint Photographic Experts Group</span>
<span class="sd">        - png - Portable Network Graphics</span>
<span class="sd">        - pnm - portable any-map format</span>
<span class="sd">        - tif - Tag Image File Format</span>
<span class="sd">        - tiff - Tag Image File Format</span>
<span class="sd">        - webp - Image file format with lossless and lossy compression</span>

<span class="sd">        After processing with Tesseract OCR, the files split previously</span>
<span class="sd">        into multiple image files are combined into a single PDF document.</span>

<span class="sd">        Args:</span>
<span class="sd">            full_name_in (str):</span>
<span class="sd">                    The directory name and file name of the input file.</span>
<span class="sd">            full_name_out (str):</span>
<span class="sd">                    The directory name and file name of the output file.</span>
<span class="sd">            language_tesseract (str):</span>
<span class="sd">                    The Tesseract name of the document language.</span>

<span class="sd">        Returns:</span>
<span class="sd">            tuple[str, str, list[str]]:</span>
<span class="sd">                    (&quot;ok&quot;, &quot;&quot;, [...]) if the processing has been completed successfully,</span>
<span class="sd">                                      otherwise a corresponding error code and error message.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">LOGGER_START</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">initialise_logger</span><span class="p">()</span>
            <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">LOGGER_START</span><span class="p">)</span>

        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;param full_name_in      =</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">full_name_in</span><span class="p">)</span>
        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;param full_name_out     =</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">full_name_out</span><span class="p">)</span>
        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;param language_tesseract=</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">language_tesseract</span><span class="p">)</span>

        <span class="n">children</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="n">pdf_writer</span> <span class="o">=</span> <span class="n">PyPDF2</span><span class="o">.</span><span class="n">PdfWriter</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">full_name</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">full_name_in</span><span class="p">)):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">pdf</span> <span class="o">=</span> <span class="n">pytesseract</span><span class="o">.</span><span class="n">image_to_pdf_or_hocr</span><span class="p">(</span>
                    <span class="n">extension</span><span class="o">=</span><span class="s2">&quot;pdf&quot;</span><span class="p">,</span>
                    <span class="n">image</span><span class="o">=</span><span class="n">full_name</span><span class="p">,</span>
                    <span class="n">lang</span><span class="o">=</span><span class="n">language_tesseract</span><span class="p">,</span>
                    <span class="n">timeout</span><span class="o">=</span><span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">setup</span><span class="o">.</span><span class="n">tesseract_timeout</span><span class="p">,</span>
                <span class="p">)</span>

                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">full_name_out</span><span class="p">,</span> <span class="s2">&quot;w+b&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file_handle</span><span class="p">:</span>
                    <span class="c1"># PDF type is bytes by default</span>
                    <span class="n">file_handle</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">pdf</span><span class="p">)</span>

                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">PyPDF2</span><span class="o">.</span><span class="n">PdfReader</span><span class="p">(</span><span class="n">full_name_out</span><span class="p">)</span><span class="o">.</span><span class="n">pages</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">error_msg</span> <span class="o">=</span> <span class="n">Process</span><span class="o">.</span><span class="n">ERROR_41_911</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{full_name_out}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">full_name_out</span><span class="p">)</span>
                    <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;return                  =</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">error_msg</span><span class="p">[:</span><span class="mi">6</span><span class="p">],</span> <span class="n">error_msg</span><span class="p">,</span> <span class="p">[]))</span>
                    <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">LOGGER_END</span><span class="p">)</span>
                    <span class="k">return</span> <span class="n">error_msg</span><span class="p">[:</span><span class="mi">6</span><span class="p">],</span> <span class="n">error_msg</span><span class="p">,</span> <span class="p">[]</span>

                <span class="n">pdf_reader</span> <span class="o">=</span> <span class="n">PyPDF2</span><span class="o">.</span><span class="n">PdfReader</span><span class="p">(</span><span class="n">full_name_out</span><span class="p">)</span>

                <span class="k">for</span> <span class="n">page</span> <span class="ow">in</span> <span class="n">pdf_reader</span><span class="o">.</span><span class="n">pages</span><span class="p">:</span>
                    <span class="c1"># Add each page to the writer object</span>
                    <span class="n">pdf_writer</span><span class="o">.</span><span class="n">add_page</span><span class="p">(</span><span class="n">page</span><span class="p">)</span>

                <span class="n">children</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">full_name</span><span class="p">)</span>

            <span class="k">except</span> <span class="ne">RuntimeError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
                <span class="n">error_msg</span> <span class="o">=</span> <span class="n">Process</span><span class="o">.</span><span class="n">ERROR_41_901</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{full_name}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">full_name_in</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{error_msg}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
                <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;return                  =</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">error_msg</span><span class="p">[:</span><span class="mi">6</span><span class="p">],</span> <span class="n">error_msg</span><span class="p">,</span> <span class="p">[]))</span>
                <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">LOGGER_END</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">error_msg</span><span class="p">[:</span><span class="mi">6</span><span class="p">],</span> <span class="n">error_msg</span><span class="p">,</span> <span class="p">[]</span>

        <span class="c1"># Write out the merged PDF</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">full_name_out</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file_handle</span><span class="p">:</span>
            <span class="n">pdf_writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">file_handle</span><span class="p">)</span>

        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="s2">&quot;return                  =</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">RETURN_OK</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">RETURN_OK</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">children</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">LOGGER_END</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">RETURN_OK</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">RETURN_OK</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">children</span>

    <span class="c1"># ------------------------------------------------------------------</span>
    <span class="c1"># Tokenizing the text from the PDF document.</span>
    <span class="c1"># ------------------------------------------------------------------</span>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">tokenizer</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">full_name_in</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">full_name_out</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">pipeline_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">document_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">full_name_orig</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="n">no_lines_footer</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">no_lines_header</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">no_lines_toc</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Tokenizing the text from the PDF document.</span>

<span class="sd">        The line-oriented text is broken down into qualified</span>
<span class="sd">        tokens with the means of SpaCy.</span>

<span class="sd">        Args:</span>
<span class="sd">            full_name_in (str):</span>
<span class="sd">                    The directory name and file name of the input file.</span>
<span class="sd">            full_name_out (str):</span>
<span class="sd">                    The directory name and file name of the output file.</span>
<span class="sd">            pipeline_name (str):</span>
<span class="sd">                    The loaded SpaCy pipeline.</span>
<span class="sd">            document_id (int, optional):</span>
<span class="sd">                    The identification number of the document.</span>
<span class="sd">                    Defaults to -1.</span>
<span class="sd">            full_name_orig (str, optional):</span>
<span class="sd">                    The file name of the originating document. Defaults to &quot;&quot;.</span>
<span class="sd">            no_lines_footer (int, optional):</span>
<span class="sd">                    Total number of footer lines.</span>
<span class="sd">                    Defaults to -1.</span>
<span class="sd">            no_lines_header (int, optional):</span>
<span class="sd">                    Total number of header lines.</span>
<span class="sd">                    Defaults to -1.</span>
<span class="sd">            no_lines_toc (int, optional):</span>
<span class="sd">                    Total number of TOC lines.</span>
<span class="sd">                    Defaults to -1.</span>

<span class="sd">        Returns:</span>
<span class="sd">            tuple[str, str]:</span>
<span class="sd">                    (&quot;ok&quot;, &quot;&quot;) if the processing has been completed successfully,</span>
<span class="sd">                               otherwise a corresponding error code and error message.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">LOGGER_START</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">initialise_logger</span><span class="p">()</span>
            <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">LOGGER_START</span><span class="p">)</span>

        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;param document_id    =</span><span class="si">%i</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">document_id</span><span class="p">)</span>
        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;param full_name_in   =</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">full_name_in</span><span class="p">)</span>
        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;param full_name_orig =</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">full_name_orig</span><span class="p">)</span>
        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;param full_name_out  =</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">full_name_out</span><span class="p">)</span>
        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;param no_lines_footer=</span><span class="si">%i</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">no_lines_footer</span><span class="p">)</span>
        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;param no_lines_header=</span><span class="si">%i</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">no_lines_header</span><span class="p">)</span>
        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;param no_lines_toc   =</span><span class="si">%i</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">no_lines_toc</span><span class="p">)</span>
        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;param pipeline_name  =</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">pipeline_name</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">text_parser</span> <span class="o">=</span> <span class="n">dcr_core</span><span class="o">.</span><span class="n">cls_text_parser</span><span class="o">.</span><span class="n">TextParser</span><span class="o">.</span><span class="n">from_files</span><span class="p">(</span>
                <span class="n">file_encoding</span><span class="o">=</span><span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">FILE_ENCODING_DEFAULT</span><span class="p">,</span> <span class="n">full_name_line</span><span class="o">=</span><span class="n">full_name_in</span>
            <span class="p">)</span>

            <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">tokenizer_spacy</span><span class="o">.</span><span class="n">process_document</span><span class="p">(</span>
                <span class="n">document_id</span><span class="o">=</span><span class="n">document_id</span><span class="p">,</span>
                <span class="n">file_name_next</span><span class="o">=</span><span class="n">full_name_out</span><span class="p">,</span>
                <span class="n">file_name_orig</span><span class="o">=</span><span class="n">full_name_orig</span><span class="p">,</span>
                <span class="n">no_lines_footer</span><span class="o">=</span><span class="n">no_lines_footer</span><span class="p">,</span>
                <span class="n">no_lines_header</span><span class="o">=</span><span class="n">no_lines_header</span><span class="p">,</span>
                <span class="n">no_lines_toc</span><span class="o">=</span><span class="n">no_lines_toc</span><span class="p">,</span>
                <span class="n">pipeline_name</span><span class="o">=</span><span class="n">pipeline_name</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
            <span class="n">error_msg</span> <span class="o">=</span> <span class="n">Process</span><span class="o">.</span><span class="n">ERROR_71_901</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{full_name}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">full_name_in</span><span class="p">)</span>
            <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;return               =</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">error_msg</span><span class="p">[:</span><span class="mi">6</span><span class="p">],</span> <span class="n">error_msg</span><span class="p">))</span>
            <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">LOGGER_END</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">error_msg</span><span class="p">[:</span><span class="mi">6</span><span class="p">],</span> <span class="n">error_msg</span>

        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;return               =</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">RETURN_OK</span><span class="p">)</span>
        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">LOGGER_END</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">RETURN_OK</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h3 id="src.dcr_core.cls_process.Process.document" class="doc doc-heading">
<code class="highlight language-python"><span class="n">document</span><span class="p">(</span><span class="n">full_name_in</span><span class="p">,</span> <span class="n">document_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">full_name_orig</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">is_delete_auxiliary_files</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">is_verbose</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">language_pandoc</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">language_spacy</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">language_tesseract</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">output_directory</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Document content recognition for a specific file.</p>
<p>This method extracts the document content structure from a
given document and stores it in JSON format. For this purpose,
all non-pdf documents and all scanned pdf documents are first
converted into a searchable pdf format. Depending on the file
format, the tools Pandoc, pdf2image or Tesseract OCR are used
for this purpose. PDFlib TET then extracts the text and metadata
from the searchable pdf file and makes them available in XML format.
spaCY generates qualified tokens from the document text, and these
token data are then made available together with the metadata in a
JSON format.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>full_name_in</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>Full file name of the document file.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>document_id</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>Document identification.
Defaults to -1 i.e. no document identification.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>full_name_orig</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>Original full file name.
Defaults to the full file name of the document file.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>is_delete_auxiliary_files</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Delete the auxiliary files after a successful processing step.
Defaults to parameter <code>delete_auxiliary_files</code> in <code>setup.cfg</code>.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>is_verbose</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Display progress messages for processing.
Defaults to parameter <code>verbose</code> in <code>setup.cfg</code>.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>language_pandoc</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>Pandoc language code.
Defaults to English.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>language_spacy</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>spaCy language code.
Defaults to English transformer pipeline (roberta-base)..</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>language_tesseract</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>Tesseract OCR language code.
Defaults to English.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>output_directory</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>Directory for the flat files to be created.
Defaults to the directory of the document file.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>RuntimeError</code>
          </td>
          <td><p>Any issue from Pandoc, pdf2image, PDFlib TET, spaCy, or Tesseract OCR.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>src/dcr_core/cls_process.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">document</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">full_name_in</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">document_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">full_name_orig</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">is_delete_auxiliary_files</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">is_verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">language_pandoc</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">language_spacy</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">language_tesseract</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">output_directory</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Document content recognition for a specific file.</span>

<span class="sd">    This method extracts the document content structure from a</span>
<span class="sd">    given document and stores it in JSON format. For this purpose,</span>
<span class="sd">    all non-pdf documents and all scanned pdf documents are first</span>
<span class="sd">    converted into a searchable pdf format. Depending on the file</span>
<span class="sd">    format, the tools Pandoc, pdf2image or Tesseract OCR are used</span>
<span class="sd">    for this purpose. PDFlib TET then extracts the text and metadata</span>
<span class="sd">    from the searchable pdf file and makes them available in XML format.</span>
<span class="sd">    spaCY generates qualified tokens from the document text, and these</span>
<span class="sd">    token data are then made available together with the metadata in a</span>
<span class="sd">    JSON format.</span>

<span class="sd">    Args:</span>
<span class="sd">        full_name_in (str):</span>
<span class="sd">            Full file name of the document file.</span>
<span class="sd">        document_id (int, optional):</span>
<span class="sd">            Document identification.</span>
<span class="sd">            Defaults to -1 i.e. no document identification.</span>
<span class="sd">        full_name_orig (str, optional):</span>
<span class="sd">            Original full file name.</span>
<span class="sd">            Defaults to the full file name of the document file.</span>
<span class="sd">        is_delete_auxiliary_files (bool, optional):</span>
<span class="sd">            Delete the auxiliary files after a successful processing step.</span>
<span class="sd">            Defaults to parameter `delete_auxiliary_files` in `setup.cfg`.</span>
<span class="sd">        is_verbose (bool, optional):</span>
<span class="sd">            Display progress messages for processing.</span>
<span class="sd">            Defaults to parameter `verbose` in `setup.cfg`.</span>
<span class="sd">        language_pandoc (str, optional):</span>
<span class="sd">            Pandoc language code.</span>
<span class="sd">            Defaults to English.</span>
<span class="sd">        language_spacy (str, optional):</span>
<span class="sd">            spaCy language code.</span>
<span class="sd">            Defaults to English transformer pipeline (roberta-base)..</span>
<span class="sd">        language_tesseract (str, optional):</span>
<span class="sd">            Tesseract OCR language code.</span>
<span class="sd">            Defaults to English.</span>
<span class="sd">        output_directory (str, optional):</span>
<span class="sd">            Directory for the flat files to be created.</span>
<span class="sd">            Defaults to the directory of the document file.</span>

<span class="sd">    Raises:</span>
<span class="sd">        RuntimeError: Any issue from Pandoc, pdf2image, PDFlib TET, spaCy, or Tesseract OCR.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Initialise the logging functionality.</span>
    <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">initialise_logger</span><span class="p">()</span>

    <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">LOGGER_START</span><span class="p">)</span>

    <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;param full_name_in=</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">full_name_in</span><span class="p">)</span>
    <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;param document_id =</span><span class="si">%i</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">document_id</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_document_init</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_document_id</span> <span class="o">=</span> <span class="n">document_id</span> <span class="k">if</span> <span class="n">document_id</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in</span> <span class="o">=</span> <span class="n">full_name_in</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_orig</span> <span class="o">=</span> <span class="n">full_name_orig</span> <span class="k">if</span> <span class="n">full_name_orig</span> <span class="k">else</span> <span class="n">full_name_in</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_language_pandoc</span> <span class="o">=</span> <span class="n">language_pandoc</span> <span class="k">if</span> <span class="n">language_pandoc</span> <span class="k">else</span> <span class="n">dcr_core</span><span class="o">.</span><span class="n">cls_nlp_core</span><span class="o">.</span><span class="n">NLPCore</span><span class="o">.</span><span class="n">LANGUAGE_PANDOC_DEFAULT</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_language_spacy</span> <span class="o">=</span> <span class="n">language_spacy</span> <span class="k">if</span> <span class="n">language_spacy</span> <span class="k">else</span> <span class="n">dcr_core</span><span class="o">.</span><span class="n">cls_nlp_core</span><span class="o">.</span><span class="n">NLPCore</span><span class="o">.</span><span class="n">LANGUAGE_SPACY_DEFAULT</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_language_tesseract</span> <span class="o">=</span> <span class="n">language_tesseract</span> <span class="k">if</span> <span class="n">language_tesseract</span> <span class="k">else</span> <span class="n">dcr_core</span><span class="o">.</span><span class="n">cls_nlp_core</span><span class="o">.</span><span class="n">NLPCore</span><span class="o">.</span><span class="n">LANGUAGE_TESSERACT_DEFAULT</span>

    <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;param full_name_orig    =</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_orig</span><span class="p">)</span>
    <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;param language_pandoc   =</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_language_pandoc</span><span class="p">)</span>
    <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;param language_spacy    =</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_language_spacy</span><span class="p">)</span>
    <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;param language_tesseract=</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_language_tesseract</span><span class="p">)</span>

    <span class="c1"># Load the configuration parameters.</span>
    <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">setup</span> <span class="o">=</span> <span class="n">dcr_core</span><span class="o">.</span><span class="n">cls_setup</span><span class="o">.</span><span class="n">Setup</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_is_delete_auxiliary_files</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">is_delete_auxiliary_files</span> <span class="k">if</span> <span class="n">is_delete_auxiliary_files</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">setup</span><span class="o">.</span><span class="n">is_delete_auxiliary_files</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_is_verbose</span> <span class="o">=</span> <span class="n">is_verbose</span> <span class="k">if</span> <span class="n">is_verbose</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">setup</span><span class="o">.</span><span class="n">is_verbose</span>

    <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_is_verbose</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Start processing document file </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_full_name_orig</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_is_verbose</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Language key Pandoc            </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_language_pandoc</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_is_verbose</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Language key spaCy             </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_language_spacy</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_is_verbose</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Language key Tesseract OCR     </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_language_tesseract</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="p">(</span>
        <span class="n">full_name_in_directory</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_stem_name</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_extension</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">=</span> <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_utils</span><span class="o">.</span><span class="n">get_components_from_full_name</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_directory</span> <span class="o">=</span> <span class="n">output_directory</span> <span class="k">if</span> <span class="n">output_directory</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">full_name_in_directory</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_extension_int</span> <span class="o">=</span> <span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_extension</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_extension</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_in_extension</span>
    <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_document_check_extension</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_document_pandoc</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_document_pdf2image</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_document_tesseract</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_document_pdflib</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_document_parser</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_document_tokenizer</span><span class="p">()</span>

    <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_is_verbose</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;End   processing document file </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_full_name_orig</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">LOGGER_END</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="src.dcr_core.cls_process.Process.pandoc" class="doc doc-heading">
<code class="highlight language-python"><span class="n">pandoc</span><span class="p">(</span><span class="n">full_name_in</span><span class="p">,</span> <span class="n">full_name_out</span><span class="p">,</span> <span class="n">language_pandoc</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Convert a Non-PDF file to a PDF file.</p>
<p>The following file formats are converted into
PDF format here with the help of Pandoc:</p>
<ul>
<li>csv - comma-separated values</li>
<li>docx - Office Open XML</li>
<li>epub - e-book file format</li>
<li>html - HyperText Markup Language</li>
<li>odt - Open Document Format for Office Applications</li>
<li>rst - reStructuredText (RST</li>
<li>rtf - Rich Text Format</li>
</ul>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>full_name_in</code></td>
          <td>
                <code>str</code>
          </td>
          <td><div class="highlight"><pre><span></span><code>The directory name and file name of the input file.
</code></pre></div></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>full_name_out</code></td>
          <td>
                <code>str</code>
          </td>
          <td><div class="highlight"><pre><span></span><code>The directory name and file name of the output file.
</code></pre></div></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>language_pandoc</code></td>
          <td>
                <code>str</code>
          </td>
          <td><div class="highlight"><pre><span></span><code>The Pandoc name of the document language.
</code></pre></div></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>tuple[str, str]</code>
          </td>
          <td><p>tuple[str, str]:
    ("ok", "") if the processing has been completed successfully,
               otherwise a corresponding error code and error message.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>src/dcr_core/cls_process.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">pandoc</span><span class="p">(</span>
    <span class="bp">cls</span><span class="p">,</span>
    <span class="n">full_name_in</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">full_name_out</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">language_pandoc</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert a Non-PDF file to a PDF file.</span>

<span class="sd">    The following file formats are converted into</span>
<span class="sd">    PDF format here with the help of Pandoc:</span>

<span class="sd">    - csv - comma-separated values</span>
<span class="sd">    - docx - Office Open XML</span>
<span class="sd">    - epub - e-book file format</span>
<span class="sd">    - html - HyperText Markup Language</span>
<span class="sd">    - odt - Open Document Format for Office Applications</span>
<span class="sd">    - rst - reStructuredText (RST</span>
<span class="sd">    - rtf - Rich Text Format</span>

<span class="sd">    Args:</span>
<span class="sd">        full_name_in (str):</span>
<span class="sd">                The directory name and file name of the input file.</span>
<span class="sd">        full_name_out (str):</span>
<span class="sd">                The directory name and file name of the output file.</span>
<span class="sd">        language_pandoc (str):</span>
<span class="sd">                The Pandoc name of the document language.</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple[str, str]:</span>
<span class="sd">                (&quot;ok&quot;, &quot;&quot;) if the processing has been completed successfully,</span>
<span class="sd">                           otherwise a corresponding error code and error message.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">LOGGER_START</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">initialise_logger</span><span class="p">()</span>
        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">LOGGER_START</span><span class="p">)</span>

    <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;param full_name_in   =</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">full_name_in</span><span class="p">)</span>
    <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;param full_name_out  =</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">full_name_out</span><span class="p">)</span>
    <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;param language_pandoc=</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">language_pandoc</span><span class="p">)</span>

    <span class="c1"># Convert the document</span>
    <span class="n">extra_args</span> <span class="o">=</span> <span class="p">[</span>
        <span class="sa">f</span><span class="s2">&quot;--pdf-engine=</span><span class="si">{</span><span class="n">Process</span><span class="o">.</span><span class="n">PANDOC_PDF_ENGINE_XELATEX</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="s2">&quot;-V&quot;</span><span class="p">,</span>
        <span class="sa">f</span><span class="s2">&quot;lang:</span><span class="si">{</span><span class="n">language_pandoc</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
    <span class="p">]</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">pypandoc</span><span class="o">.</span><span class="n">convert_file</span><span class="p">(</span>
            <span class="n">full_name_in</span><span class="p">,</span>
            <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">FILE_TYPE_PDF</span><span class="p">,</span>
            <span class="n">extra_args</span><span class="o">=</span><span class="n">extra_args</span><span class="p">,</span>
            <span class="n">outputfile</span><span class="o">=</span><span class="n">full_name_out</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">PyPDF2</span><span class="o">.</span><span class="n">PdfReader</span><span class="p">(</span><span class="n">full_name_out</span><span class="p">)</span><span class="o">.</span><span class="n">pages</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">error_msg</span> <span class="o">=</span> <span class="n">Process</span><span class="o">.</span><span class="n">ERROR_31_911</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{full_name}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">full_name_out</span><span class="p">)</span>
            <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;return               =</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">error_msg</span><span class="p">[:</span><span class="mi">6</span><span class="p">],</span> <span class="n">error_msg</span><span class="p">))</span>
            <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">LOGGER_END</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">error_msg</span><span class="p">[:</span><span class="mi">6</span><span class="p">],</span> <span class="n">error_msg</span>

    <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
        <span class="n">error_msg</span> <span class="o">=</span> <span class="n">Process</span><span class="o">.</span><span class="n">ERROR_31_902</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{full_name}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">full_name_in</span><span class="p">)</span>
        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;return               =</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">error_msg</span><span class="p">[:</span><span class="mi">6</span><span class="p">],</span> <span class="n">error_msg</span><span class="p">))</span>
        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">LOGGER_END</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">error_msg</span><span class="p">[:</span><span class="mi">6</span><span class="p">],</span> <span class="n">error_msg</span>
    <span class="k">except</span> <span class="ne">RuntimeError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
        <span class="n">error_msg</span> <span class="o">=</span> <span class="n">Process</span><span class="o">.</span><span class="n">ERROR_31_903</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{full_name}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">full_name_in</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{error_msg}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;return               =</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">error_msg</span><span class="p">[:</span><span class="mi">6</span><span class="p">],</span> <span class="n">error_msg</span><span class="p">))</span>
        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">LOGGER_END</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">error_msg</span><span class="p">[:</span><span class="mi">6</span><span class="p">],</span> <span class="n">error_msg</span>

    <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;return               =</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">RETURN_OK</span><span class="p">)</span>
    <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">LOGGER_END</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">RETURN_OK</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="src.dcr_core.cls_process.Process.parser" class="doc doc-heading">
<code class="highlight language-python"><span class="n">parser</span><span class="p">(</span><span class="n">full_name_in</span><span class="p">,</span> <span class="n">full_name_out</span><span class="p">,</span> <span class="n">no_pdf_pages</span><span class="p">,</span> <span class="n">document_id</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">full_name_orig</span><span class="o">=</span><span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">INFORMATION_NOT_YET_AVAILABLE</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Extract the text from the PDF document.</p>
<p>From the line-oriented XML output file of PDFlib TET,
the text and relevant metadata are extracted with the
help of an XML parser and stored in a JSON file.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>full_name_in</code></td>
          <td>
                <code>str</code>
          </td>
          <td><div class="highlight"><pre><span></span><code>The directory name and file name of the input file.
</code></pre></div></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>full_name_out</code></td>
          <td>
                <code>str</code>
          </td>
          <td><div class="highlight"><pre><span></span><code>The directory name and file name of the output file.
</code></pre></div></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>no_pdf_pages</code></td>
          <td>
                <code>int</code>
          </td>
          <td><div class="highlight"><pre><span></span><code>Total number of PDF pages.
</code></pre></div></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>document_id</code></td>
          <td>
                <code>int</code>
          </td>
          <td><div class="highlight"><pre><span></span><code>The identification number of the document.
Defaults to -1.
</code></pre></div></td>
          <td>
                <code>-1</code>
          </td>
        </tr>
        <tr>
          <td><code>full_name_orig</code></td>
          <td>
                <code>str</code>
          </td>
          <td><div class="highlight"><pre><span></span><code>The file name of the originating document.
Defaults to dcr_core.core_glob.INFORMATION_NOT_YET_AVAILABLE.
</code></pre></div></td>
          <td>
                <code>dcr_core.core_glob.INFORMATION_NOT_YET_AVAILABLE</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>tuple[str, str]</code>
          </td>
          <td><p>tuple[str, str]:
    ("ok", "") if the processing has been completed successfully,
               otherwise a corresponding error code and error message.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>src/dcr_core/cls_process.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">parser</span><span class="p">(</span>
    <span class="bp">cls</span><span class="p">,</span>
    <span class="n">full_name_in</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">full_name_out</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">no_pdf_pages</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">document_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">full_name_orig</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">INFORMATION_NOT_YET_AVAILABLE</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Extract the text from the PDF document.</span>

<span class="sd">    From the line-oriented XML output file of PDFlib TET,</span>
<span class="sd">    the text and relevant metadata are extracted with the</span>
<span class="sd">    help of an XML parser and stored in a JSON file.</span>

<span class="sd">    Args:</span>
<span class="sd">        full_name_in (str):</span>
<span class="sd">                The directory name and file name of the input file.</span>
<span class="sd">        full_name_out (str):</span>
<span class="sd">                The directory name and file name of the output file.</span>
<span class="sd">        no_pdf_pages (int):</span>
<span class="sd">                Total number of PDF pages.</span>
<span class="sd">        document_id (int, optional):</span>
<span class="sd">                The identification number of the document.</span>
<span class="sd">                Defaults to -1.</span>
<span class="sd">        full_name_orig (str, optional):</span>
<span class="sd">                The file name of the originating document.</span>
<span class="sd">                Defaults to dcr_core.core_glob.INFORMATION_NOT_YET_AVAILABLE.</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple[str, str]:</span>
<span class="sd">                (&quot;ok&quot;, &quot;&quot;) if the processing has been completed successfully,</span>
<span class="sd">                           otherwise a corresponding error code and error message.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">LOGGER_START</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">initialise_logger</span><span class="p">()</span>
        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">LOGGER_START</span><span class="p">)</span>

    <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;param document_id   =</span><span class="si">%i</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">document_id</span><span class="p">)</span>
    <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;param full_name_orig=</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">full_name_orig</span><span class="p">)</span>
    <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;param full_name_in  =</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">full_name_in</span><span class="p">)</span>
    <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;param full_name_out =</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">full_name_out</span><span class="p">)</span>
    <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;param no_pdf_pages  =</span><span class="si">%i</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">no_pdf_pages</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Create the Element tree object</span>
        <span class="n">tree</span> <span class="o">=</span> <span class="n">defusedxml</span><span class="o">.</span><span class="n">ElementTree</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">full_name_in</span><span class="p">)</span>

        <span class="c1"># Get the root Element</span>
        <span class="n">root</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">getroot</span><span class="p">()</span>

        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">text_parser</span> <span class="o">=</span> <span class="n">dcr_core</span><span class="o">.</span><span class="n">cls_text_parser</span><span class="o">.</span><span class="n">TextParser</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">root</span><span class="p">:</span>
            <span class="n">child_tag</span> <span class="o">=</span> <span class="n">child</span><span class="o">.</span><span class="n">tag</span><span class="p">[</span><span class="n">dcr_core</span><span class="o">.</span><span class="n">cls_nlp_core</span><span class="o">.</span><span class="n">NLPCore</span><span class="o">.</span><span class="n">PARSE_ELEM_FROM</span> <span class="p">:]</span>
            <span class="k">match</span> <span class="n">child_tag</span><span class="p">:</span>
                <span class="k">case</span> <span class="n">dcr_core</span><span class="o">.</span><span class="n">cls_nlp_core</span><span class="o">.</span><span class="n">NLPCore</span><span class="o">.</span><span class="n">PARSE_ELEM_DOCUMENT</span><span class="p">:</span>
                    <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">text_parser</span><span class="o">.</span><span class="n">parse_tag_document</span><span class="p">(</span>
                        <span class="n">directory_name</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">full_name_in</span><span class="p">),</span>
                        <span class="n">document_id</span><span class="o">=</span><span class="n">document_id</span><span class="p">,</span>
                        <span class="n">environment_variant</span><span class="o">=</span><span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">setup</span><span class="o">.</span><span class="n">environment_variant</span><span class="p">,</span>
                        <span class="n">file_name_curr</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">full_name_in</span><span class="p">),</span>
                        <span class="n">file_name_next</span><span class="o">=</span><span class="n">full_name_out</span><span class="p">,</span>
                        <span class="n">file_name_orig</span><span class="o">=</span><span class="n">full_name_orig</span><span class="p">,</span>
                        <span class="n">no_pdf_pages</span><span class="o">=</span><span class="n">no_pdf_pages</span><span class="p">,</span>
                        <span class="n">parent</span><span class="o">=</span><span class="n">child</span><span class="p">,</span>
                        <span class="n">parent_tag</span><span class="o">=</span><span class="n">child_tag</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="k">case</span> <span class="n">dcr_core</span><span class="o">.</span><span class="n">cls_nlp_core</span><span class="o">.</span><span class="n">NLPCore</span><span class="o">.</span><span class="n">PARSE_ELEM_CREATION</span><span class="p">:</span>
                    <span class="k">pass</span>
    <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
        <span class="n">error_msg</span> <span class="o">=</span> <span class="n">Process</span><span class="o">.</span><span class="n">ERROR_61_901</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{full_name}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">full_name_in</span><span class="p">)</span>
        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;return              =</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">error_msg</span><span class="p">[:</span><span class="mi">6</span><span class="p">],</span> <span class="n">error_msg</span><span class="p">))</span>
        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">LOGGER_END</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">error_msg</span><span class="p">[:</span><span class="mi">6</span><span class="p">],</span> <span class="n">error_msg</span>

    <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;return              =</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">RETURN_OK</span><span class="p">)</span>
    <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">LOGGER_END</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">RETURN_OK</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="src.dcr_core.cls_process.Process.pdf2image" class="doc doc-heading">
<code class="highlight language-python"><span class="n">pdf2image</span><span class="p">(</span><span class="n">full_name_in</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Convert a scanned PDF file to a set of image files.</p>
<p>To extract the text from a scanned PDF document, it must
first be converted into one or more image files, depending
on the number of pages. Then these image files are converted
into a normal PDF document with the help of an OCR programme.
The input file for this method must be a scanned PDF document,
which is then converted into image files with the help of PDF2Image.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>full_name_in</code></td>
          <td>
                <code>str</code>
          </td>
          <td><div class="highlight"><pre><span></span><code>The directory name and file name of the input file.
</code></pre></div></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>tuple[str, str, list[tuple[str, str]]]</code>
          </td>
          <td><p>tuple[str, str, list[tuple[str,str]]]:
    ("ok", "", [...]) if the processing has been completed successfully,
                      otherwise a corresponding error code and error message.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>src/dcr_core/cls_process.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span>
<span class="normal">864</span>
<span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span>
<span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span>
<span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span>
<span class="normal">901</span>
<span class="normal">902</span>
<span class="normal">903</span>
<span class="normal">904</span>
<span class="normal">905</span>
<span class="normal">906</span>
<span class="normal">907</span>
<span class="normal">908</span>
<span class="normal">909</span>
<span class="normal">910</span>
<span class="normal">911</span>
<span class="normal">912</span>
<span class="normal">913</span>
<span class="normal">914</span>
<span class="normal">915</span>
<span class="normal">916</span>
<span class="normal">917</span>
<span class="normal">918</span>
<span class="normal">919</span>
<span class="normal">920</span>
<span class="normal">921</span>
<span class="normal">922</span>
<span class="normal">923</span>
<span class="normal">924</span>
<span class="normal">925</span>
<span class="normal">926</span>
<span class="normal">927</span>
<span class="normal">928</span>
<span class="normal">929</span>
<span class="normal">930</span>
<span class="normal">931</span>
<span class="normal">932</span>
<span class="normal">933</span>
<span class="normal">934</span>
<span class="normal">935</span>
<span class="normal">936</span>
<span class="normal">937</span>
<span class="normal">938</span>
<span class="normal">939</span>
<span class="normal">940</span>
<span class="normal">941</span>
<span class="normal">942</span>
<span class="normal">943</span>
<span class="normal">944</span>
<span class="normal">945</span>
<span class="normal">946</span>
<span class="normal">947</span>
<span class="normal">948</span>
<span class="normal">949</span>
<span class="normal">950</span>
<span class="normal">951</span>
<span class="normal">952</span>
<span class="normal">953</span>
<span class="normal">954</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">pdf2image</span><span class="p">(</span>
    <span class="bp">cls</span><span class="p">,</span>
    <span class="n">full_name_in</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert a scanned PDF file to a set of image files.</span>

<span class="sd">    To extract the text from a scanned PDF document, it must</span>
<span class="sd">    first be converted into one or more image files, depending</span>
<span class="sd">    on the number of pages. Then these image files are converted</span>
<span class="sd">    into a normal PDF document with the help of an OCR programme.</span>
<span class="sd">    The input file for this method must be a scanned PDF document,</span>
<span class="sd">    which is then converted into image files with the help of PDF2Image.</span>

<span class="sd">    Args:</span>
<span class="sd">        full_name_in (str):</span>
<span class="sd">                The directory name and file name of the input file.</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple[str, str, list[tuple[str,str]]]:</span>
<span class="sd">                (&quot;ok&quot;, &quot;&quot;, [...]) if the processing has been completed successfully,</span>
<span class="sd">                                  otherwise a corresponding error code and error message.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">LOGGER_START</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">initialise_logger</span><span class="p">()</span>
        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">LOGGER_START</span><span class="p">)</span>

    <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;param full_name_in=</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">full_name_in</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">images</span> <span class="o">=</span> <span class="n">pdf2image</span><span class="o">.</span><span class="n">convert_from_path</span><span class="p">(</span><span class="n">full_name_in</span><span class="p">)</span>

        <span class="n">children</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">no_children</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="n">directory_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">full_name_in</span><span class="p">)</span>
        <span class="n">stem_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">full_name_in</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span>
                <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_utils</span><span class="o">.</span><span class="n">get_full_name_from_components</span><span class="p">(</span>
                    <span class="n">directory_name</span><span class="p">,</span>
                    <span class="n">stem_name</span>
                    <span class="o">+</span> <span class="s2">&quot;_*.&quot;</span>
                    <span class="o">+</span> <span class="p">(</span>
                        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">FILE_TYPE_PNG</span>
                        <span class="k">if</span> <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">setup</span><span class="o">.</span><span class="n">pdf2image_type</span> <span class="o">==</span> <span class="n">dcr_core</span><span class="o">.</span><span class="n">cls_setup</span><span class="o">.</span><span class="n">Setup</span><span class="o">.</span><span class="n">PDF2IMAGE_TYPE_PNG</span>
                        <span class="k">else</span> <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">FILE_TYPE_JPEG</span>
                    <span class="p">),</span>
                <span class="p">)</span>
            <span class="p">)</span>
        <span class="k">except</span> <span class="ne">OSError</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="c1"># Store the image pages</span>
        <span class="k">for</span> <span class="n">img</span> <span class="ow">in</span> <span class="n">images</span><span class="p">:</span>
            <span class="n">no_children</span> <span class="o">+=</span> <span class="mi">1</span>

            <span class="n">file_name_next</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">stem_name</span>
                <span class="o">+</span> <span class="s2">&quot;_&quot;</span>
                <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">no_children</span><span class="p">)</span>
                <span class="o">+</span> <span class="s2">&quot;.&quot;</span>
                <span class="o">+</span> <span class="p">(</span>
                    <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">FILE_TYPE_PNG</span>
                    <span class="k">if</span> <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">setup</span><span class="o">.</span><span class="n">pdf2image_type</span> <span class="o">==</span> <span class="n">dcr_core</span><span class="o">.</span><span class="n">cls_setup</span><span class="o">.</span><span class="n">Setup</span><span class="o">.</span><span class="n">PDF2IMAGE_TYPE_PNG</span>
                    <span class="k">else</span> <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">FILE_TYPE_JPEG</span>
                <span class="p">)</span>
            <span class="p">)</span>

            <span class="n">full_name_next</span> <span class="o">=</span> <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_utils</span><span class="o">.</span><span class="n">get_full_name_from_components</span><span class="p">(</span>
                <span class="n">directory_name</span><span class="p">,</span>
                <span class="n">file_name_next</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="n">img</span><span class="o">.</span><span class="n">save</span><span class="p">(</span>
                <span class="n">full_name_next</span><span class="p">,</span>
                <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">setup</span><span class="o">.</span><span class="n">pdf2image_type</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="n">children</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">file_name_next</span><span class="p">,</span> <span class="n">full_name_next</span><span class="p">))</span>
    <span class="k">except</span> <span class="n">PDFPageCountError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
        <span class="n">error_msg</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">Process</span><span class="o">.</span><span class="n">ERROR_21_901</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{full_name}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">full_name_in</span><span class="p">)</span>
            <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{error_type}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">err</span><span class="p">)))</span>
            <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{error_msg}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
        <span class="p">)</span>
        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;return            =</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">error_msg</span><span class="p">[:</span><span class="mi">6</span><span class="p">],</span> <span class="n">error_msg</span><span class="p">,</span> <span class="p">[]))</span>
        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">LOGGER_END</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">error_msg</span><span class="p">[:</span><span class="mi">6</span><span class="p">],</span> <span class="n">error_msg</span><span class="p">,</span> <span class="p">[]</span>

    <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
        <span class="s2">&quot;return            =</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">RETURN_OK</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">RETURN_OK</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">children</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">LOGGER_END</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">RETURN_OK</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">RETURN_OK</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">children</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="src.dcr_core.cls_process.Process.pdflib" class="doc doc-heading">
<code class="highlight language-python"><span class="n">pdflib</span><span class="p">(</span><span class="n">full_name_in</span><span class="p">,</span> <span class="n">full_name_out</span><span class="p">,</span> <span class="n">document_opt_list</span><span class="p">,</span> <span class="n">page_opt_list</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Process a PDF file with PDFlib TET.</p>
<p>The data from a PDF file is made available in XML files
with the help of PDFlib TET. The granularity of the XML
files can be word, line or paragraph depending on the
document and page options selected.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>full_name_in</code></td>
          <td>
                <code>str</code>
          </td>
          <td><div class="highlight"><pre><span></span><code>Directory name and file name of the input file.
</code></pre></div></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>full_name_out</code></td>
          <td>
                <code>str</code>
          </td>
          <td><div class="highlight"><pre><span></span><code>Directory name and file name of the output file.
</code></pre></div></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>document_opt_list</code></td>
          <td>
                <code>str</code>
          </td>
          <td><div class="highlight"><pre><span></span><code>Document level options:
    word: engines={noannotation noimage text notextcolor novector}
    line: engines={noannotation noimage text notextcolor novector}
    page: engines={noannotation noimage text notextcolor novector} lineseparator=U+0020
</code></pre></div></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>page_opt_list</code></td>
          <td>
                <code>str</code>
          </td>
          <td><div class="highlight"><pre><span></span><code>Page level options:
    word: granularity=word tetml={elements={line}}
    line: granularity=line
    page: granularity=page
</code></pre></div></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>tuple[str, str]</code>
          </td>
          <td><p>tuple[str, str]:
    ("ok", "") if the processing has been completed successfully,
               otherwise a corresponding error code and error message.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>src/dcr_core/cls_process.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 959</span>
<span class="normal"> 960</span>
<span class="normal"> 961</span>
<span class="normal"> 962</span>
<span class="normal"> 963</span>
<span class="normal"> 964</span>
<span class="normal"> 965</span>
<span class="normal"> 966</span>
<span class="normal"> 967</span>
<span class="normal"> 968</span>
<span class="normal"> 969</span>
<span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">pdflib</span><span class="p">(</span>
    <span class="bp">cls</span><span class="p">,</span>
    <span class="n">full_name_in</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">full_name_out</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">document_opt_list</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">page_opt_list</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Process a PDF file with PDFlib TET.</span>

<span class="sd">    The data from a PDF file is made available in XML files</span>
<span class="sd">    with the help of PDFlib TET. The granularity of the XML</span>
<span class="sd">    files can be word, line or paragraph depending on the</span>
<span class="sd">    document and page options selected.</span>

<span class="sd">    Args:</span>
<span class="sd">        full_name_in (str):</span>
<span class="sd">                Directory name and file name of the input file.</span>
<span class="sd">        full_name_out (str):</span>
<span class="sd">                Directory name and file name of the output file.</span>
<span class="sd">        document_opt_list (str):</span>
<span class="sd">                Document level options:</span>
<span class="sd">                    word: engines={noannotation noimage text notextcolor novector}</span>
<span class="sd">                    line: engines={noannotation noimage text notextcolor novector}</span>
<span class="sd">                    page: engines={noannotation noimage text notextcolor novector} lineseparator=U+0020</span>
<span class="sd">        page_opt_list (str):</span>
<span class="sd">                Page level options:</span>
<span class="sd">                    word: granularity=word tetml={elements={line}}</span>
<span class="sd">                    line: granularity=line</span>
<span class="sd">                    page: granularity=page</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple[str, str]:</span>
<span class="sd">                (&quot;ok&quot;, &quot;&quot;) if the processing has been completed successfully,</span>
<span class="sd">                           otherwise a corresponding error code and error message.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">LOGGER_START</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">initialise_logger</span><span class="p">()</span>
        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">LOGGER_START</span><span class="p">)</span>

    <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;param full_name_in     =</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">full_name_in</span><span class="p">)</span>
    <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;param full_name_out    =</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">full_name_out</span><span class="p">)</span>
    <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;param document_opt_list=</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">document_opt_list</span><span class="p">)</span>
    <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;param page_opt_list    =</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">page_opt_list</span><span class="p">)</span>

    <span class="n">tet</span> <span class="o">=</span> <span class="n">dcr_core</span><span class="o">.</span><span class="n">PDFlib</span><span class="o">.</span><span class="n">TET</span><span class="o">.</span><span class="n">TET</span><span class="p">()</span>

    <span class="n">doc_opt_list</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;tetml=</span><span class="se">{{</span><span class="s2">filename=</span><span class="se">{{</span><span class="si">{</span><span class="n">full_name_out</span><span class="si">}</span><span class="se">}}}}</span><span class="s2"> </span><span class="si">{</span><span class="n">document_opt_list</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">file_curr</span> <span class="o">:=</span> <span class="n">tet</span><span class="o">.</span><span class="n">open_document</span><span class="p">(</span><span class="n">full_name_in</span><span class="p">,</span> <span class="n">doc_opt_list</span><span class="p">))</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="n">error_msg</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">Process</span><span class="o">.</span><span class="n">ERROR_51_901</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{full_name}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">full_name_in</span><span class="p">)</span>
            <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{error_no}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">tet</span><span class="o">.</span><span class="n">get_errnum</span><span class="p">()))</span>
            <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{api_name}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">tet</span><span class="o">.</span><span class="n">get_apiname</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;()&quot;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{error_msg}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">tet</span><span class="o">.</span><span class="n">get_errmsg</span><span class="p">())</span>
        <span class="p">)</span>
        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;return                 =</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">error_msg</span><span class="p">[:</span><span class="mi">6</span><span class="p">],</span> <span class="n">error_msg</span><span class="p">))</span>
        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">LOGGER_END</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">error_msg</span><span class="p">[:</span><span class="mi">6</span><span class="p">],</span> <span class="n">error_msg</span>

    <span class="c1"># get number of pages in the document */</span>
    <span class="n">no_pages</span> <span class="o">=</span> <span class="n">tet</span><span class="o">.</span><span class="n">pcos_get_number</span><span class="p">(</span><span class="n">file_curr</span><span class="p">,</span> <span class="s2">&quot;length:pages&quot;</span><span class="p">)</span>

    <span class="c1"># loop over pages in the document */</span>
    <span class="k">for</span> <span class="n">page_no</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">no_pages</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">tet</span><span class="o">.</span><span class="n">process_page</span><span class="p">(</span><span class="n">file_curr</span><span class="p">,</span> <span class="n">page_no</span><span class="p">,</span> <span class="n">page_opt_list</span><span class="p">)</span>

    <span class="c1"># This could be combined with the last page-related call</span>
    <span class="n">tet</span><span class="o">.</span><span class="n">process_page</span><span class="p">(</span><span class="n">file_curr</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;tetml=</span><span class="si">{trailer}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">tet</span><span class="o">.</span><span class="n">close_document</span><span class="p">(</span><span class="n">file_curr</span><span class="p">)</span>

    <span class="n">tet</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>

    <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;return                 =</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">LOGGER_END</span><span class="p">)</span>
    <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">LOGGER_END</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">RETURN_OK</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="src.dcr_core.cls_process.Process.tesseract" class="doc doc-heading">
<code class="highlight language-python"><span class="n">tesseract</span><span class="p">(</span><span class="n">full_name_in</span><span class="p">,</span> <span class="n">full_name_out</span><span class="p">,</span> <span class="n">language_tesseract</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Convert image files to PDF files via OCR.</p>
<p>The documents of the following document types are converted
to the PDF format using Tesseract OCR:</p>
<ul>
<li>bmp - bitmap image file</li>
<li>gif - Graphics Interchange Format</li>
<li>jp2 - JPEG 2000</li>
<li>jpeg - Joint Photographic Experts Group</li>
<li>png - Portable Network Graphics</li>
<li>pnm - portable any-map format</li>
<li>tif - Tag Image File Format</li>
<li>tiff - Tag Image File Format</li>
<li>webp - Image file format with lossless and lossy compression</li>
</ul>
<p>After processing with Tesseract OCR, the files split previously
into multiple image files are combined into a single PDF document.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>full_name_in</code></td>
          <td>
                <code>str</code>
          </td>
          <td><div class="highlight"><pre><span></span><code>The directory name and file name of the input file.
</code></pre></div></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>full_name_out</code></td>
          <td>
                <code>str</code>
          </td>
          <td><div class="highlight"><pre><span></span><code>The directory name and file name of the output file.
</code></pre></div></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>language_tesseract</code></td>
          <td>
                <code>str</code>
          </td>
          <td><div class="highlight"><pre><span></span><code>The Tesseract name of the document language.
</code></pre></div></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>tuple[str, str, list[str]]</code>
          </td>
          <td><p>tuple[str, str, list[str]]:
    ("ok", "", [...]) if the processing has been completed successfully,
                      otherwise a corresponding error code and error message.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>src/dcr_core/cls_process.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">tesseract</span><span class="p">(</span>
    <span class="bp">cls</span><span class="p">,</span>
    <span class="n">full_name_in</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">full_name_out</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">language_tesseract</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert image files to PDF files via OCR.</span>

<span class="sd">    The documents of the following document types are converted</span>
<span class="sd">    to the PDF format using Tesseract OCR:</span>

<span class="sd">    - bmp - bitmap image file</span>
<span class="sd">    - gif - Graphics Interchange Format</span>
<span class="sd">    - jp2 - JPEG 2000</span>
<span class="sd">    - jpeg - Joint Photographic Experts Group</span>
<span class="sd">    - png - Portable Network Graphics</span>
<span class="sd">    - pnm - portable any-map format</span>
<span class="sd">    - tif - Tag Image File Format</span>
<span class="sd">    - tiff - Tag Image File Format</span>
<span class="sd">    - webp - Image file format with lossless and lossy compression</span>

<span class="sd">    After processing with Tesseract OCR, the files split previously</span>
<span class="sd">    into multiple image files are combined into a single PDF document.</span>

<span class="sd">    Args:</span>
<span class="sd">        full_name_in (str):</span>
<span class="sd">                The directory name and file name of the input file.</span>
<span class="sd">        full_name_out (str):</span>
<span class="sd">                The directory name and file name of the output file.</span>
<span class="sd">        language_tesseract (str):</span>
<span class="sd">                The Tesseract name of the document language.</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple[str, str, list[str]]:</span>
<span class="sd">                (&quot;ok&quot;, &quot;&quot;, [...]) if the processing has been completed successfully,</span>
<span class="sd">                                  otherwise a corresponding error code and error message.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">LOGGER_START</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">initialise_logger</span><span class="p">()</span>
        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">LOGGER_START</span><span class="p">)</span>

    <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;param full_name_in      =</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">full_name_in</span><span class="p">)</span>
    <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;param full_name_out     =</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">full_name_out</span><span class="p">)</span>
    <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;param language_tesseract=</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">language_tesseract</span><span class="p">)</span>

    <span class="n">children</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">pdf_writer</span> <span class="o">=</span> <span class="n">PyPDF2</span><span class="o">.</span><span class="n">PdfWriter</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">full_name</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">full_name_in</span><span class="p">)):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">pdf</span> <span class="o">=</span> <span class="n">pytesseract</span><span class="o">.</span><span class="n">image_to_pdf_or_hocr</span><span class="p">(</span>
                <span class="n">extension</span><span class="o">=</span><span class="s2">&quot;pdf&quot;</span><span class="p">,</span>
                <span class="n">image</span><span class="o">=</span><span class="n">full_name</span><span class="p">,</span>
                <span class="n">lang</span><span class="o">=</span><span class="n">language_tesseract</span><span class="p">,</span>
                <span class="n">timeout</span><span class="o">=</span><span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">setup</span><span class="o">.</span><span class="n">tesseract_timeout</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">full_name_out</span><span class="p">,</span> <span class="s2">&quot;w+b&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file_handle</span><span class="p">:</span>
                <span class="c1"># PDF type is bytes by default</span>
                <span class="n">file_handle</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">pdf</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">PyPDF2</span><span class="o">.</span><span class="n">PdfReader</span><span class="p">(</span><span class="n">full_name_out</span><span class="p">)</span><span class="o">.</span><span class="n">pages</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">error_msg</span> <span class="o">=</span> <span class="n">Process</span><span class="o">.</span><span class="n">ERROR_41_911</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{full_name_out}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">full_name_out</span><span class="p">)</span>
                <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;return                  =</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">error_msg</span><span class="p">[:</span><span class="mi">6</span><span class="p">],</span> <span class="n">error_msg</span><span class="p">,</span> <span class="p">[]))</span>
                <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">LOGGER_END</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">error_msg</span><span class="p">[:</span><span class="mi">6</span><span class="p">],</span> <span class="n">error_msg</span><span class="p">,</span> <span class="p">[]</span>

            <span class="n">pdf_reader</span> <span class="o">=</span> <span class="n">PyPDF2</span><span class="o">.</span><span class="n">PdfReader</span><span class="p">(</span><span class="n">full_name_out</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">page</span> <span class="ow">in</span> <span class="n">pdf_reader</span><span class="o">.</span><span class="n">pages</span><span class="p">:</span>
                <span class="c1"># Add each page to the writer object</span>
                <span class="n">pdf_writer</span><span class="o">.</span><span class="n">add_page</span><span class="p">(</span><span class="n">page</span><span class="p">)</span>

            <span class="n">children</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">full_name</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">RuntimeError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">error_msg</span> <span class="o">=</span> <span class="n">Process</span><span class="o">.</span><span class="n">ERROR_41_901</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{full_name}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">full_name_in</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{error_msg}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
            <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;return                  =</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">error_msg</span><span class="p">[:</span><span class="mi">6</span><span class="p">],</span> <span class="n">error_msg</span><span class="p">,</span> <span class="p">[]))</span>
            <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">LOGGER_END</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">error_msg</span><span class="p">[:</span><span class="mi">6</span><span class="p">],</span> <span class="n">error_msg</span><span class="p">,</span> <span class="p">[]</span>

    <span class="c1"># Write out the merged PDF</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">full_name_out</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file_handle</span><span class="p">:</span>
        <span class="n">pdf_writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">file_handle</span><span class="p">)</span>

    <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
        <span class="s2">&quot;return                  =</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">RETURN_OK</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">RETURN_OK</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">children</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">LOGGER_END</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">RETURN_OK</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">RETURN_OK</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">children</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="src.dcr_core.cls_process.Process.tokenizer" class="doc doc-heading">
<code class="highlight language-python"><span class="n">tokenizer</span><span class="p">(</span><span class="n">full_name_in</span><span class="p">,</span> <span class="n">full_name_out</span><span class="p">,</span> <span class="n">pipeline_name</span><span class="p">,</span> <span class="n">document_id</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">full_name_orig</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">no_lines_footer</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">no_lines_header</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">no_lines_toc</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Tokenizing the text from the PDF document.</p>
<p>The line-oriented text is broken down into qualified
tokens with the means of SpaCy.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>full_name_in</code></td>
          <td>
                <code>str</code>
          </td>
          <td><div class="highlight"><pre><span></span><code>The directory name and file name of the input file.
</code></pre></div></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>full_name_out</code></td>
          <td>
                <code>str</code>
          </td>
          <td><div class="highlight"><pre><span></span><code>The directory name and file name of the output file.
</code></pre></div></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>pipeline_name</code></td>
          <td>
                <code>str</code>
          </td>
          <td><div class="highlight"><pre><span></span><code>The loaded SpaCy pipeline.
</code></pre></div></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>document_id</code></td>
          <td>
                <code>int</code>
          </td>
          <td><div class="highlight"><pre><span></span><code>The identification number of the document.
Defaults to -1.
</code></pre></div></td>
          <td>
                <code>-1</code>
          </td>
        </tr>
        <tr>
          <td><code>full_name_orig</code></td>
          <td>
                <code>str</code>
          </td>
          <td><div class="highlight"><pre><span></span><code>The file name of the originating document. Defaults to &quot;&quot;.
</code></pre></div></td>
          <td>
                <code>&#39;&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>no_lines_footer</code></td>
          <td>
                <code>int</code>
          </td>
          <td><div class="highlight"><pre><span></span><code>Total number of footer lines.
Defaults to -1.
</code></pre></div></td>
          <td>
                <code>-1</code>
          </td>
        </tr>
        <tr>
          <td><code>no_lines_header</code></td>
          <td>
                <code>int</code>
          </td>
          <td><div class="highlight"><pre><span></span><code>Total number of header lines.
Defaults to -1.
</code></pre></div></td>
          <td>
                <code>-1</code>
          </td>
        </tr>
        <tr>
          <td><code>no_lines_toc</code></td>
          <td>
                <code>int</code>
          </td>
          <td><div class="highlight"><pre><span></span><code>Total number of TOC lines.
Defaults to -1.
</code></pre></div></td>
          <td>
                <code>-1</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>tuple[str, str]</code>
          </td>
          <td><p>tuple[str, str]:
    ("ok", "") if the processing has been completed successfully,
               otherwise a corresponding error code and error message.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>src/dcr_core/cls_process.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span>
<span class="normal">1167</span>
<span class="normal">1168</span>
<span class="normal">1169</span>
<span class="normal">1170</span>
<span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span>
<span class="normal">1174</span>
<span class="normal">1175</span>
<span class="normal">1176</span>
<span class="normal">1177</span>
<span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span>
<span class="normal">1182</span>
<span class="normal">1183</span>
<span class="normal">1184</span>
<span class="normal">1185</span>
<span class="normal">1186</span>
<span class="normal">1187</span>
<span class="normal">1188</span>
<span class="normal">1189</span>
<span class="normal">1190</span>
<span class="normal">1191</span>
<span class="normal">1192</span>
<span class="normal">1193</span>
<span class="normal">1194</span>
<span class="normal">1195</span>
<span class="normal">1196</span>
<span class="normal">1197</span>
<span class="normal">1198</span>
<span class="normal">1199</span>
<span class="normal">1200</span>
<span class="normal">1201</span>
<span class="normal">1202</span>
<span class="normal">1203</span>
<span class="normal">1204</span>
<span class="normal">1205</span>
<span class="normal">1206</span>
<span class="normal">1207</span>
<span class="normal">1208</span>
<span class="normal">1209</span>
<span class="normal">1210</span>
<span class="normal">1211</span>
<span class="normal">1212</span>
<span class="normal">1213</span>
<span class="normal">1214</span>
<span class="normal">1215</span>
<span class="normal">1216</span>
<span class="normal">1217</span>
<span class="normal">1218</span>
<span class="normal">1219</span>
<span class="normal">1220</span>
<span class="normal">1221</span>
<span class="normal">1222</span>
<span class="normal">1223</span>
<span class="normal">1224</span>
<span class="normal">1225</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">tokenizer</span><span class="p">(</span>
    <span class="bp">cls</span><span class="p">,</span>
    <span class="n">full_name_in</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">full_name_out</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">pipeline_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">document_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">full_name_orig</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="n">no_lines_footer</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">no_lines_header</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">no_lines_toc</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Tokenizing the text from the PDF document.</span>

<span class="sd">    The line-oriented text is broken down into qualified</span>
<span class="sd">    tokens with the means of SpaCy.</span>

<span class="sd">    Args:</span>
<span class="sd">        full_name_in (str):</span>
<span class="sd">                The directory name and file name of the input file.</span>
<span class="sd">        full_name_out (str):</span>
<span class="sd">                The directory name and file name of the output file.</span>
<span class="sd">        pipeline_name (str):</span>
<span class="sd">                The loaded SpaCy pipeline.</span>
<span class="sd">        document_id (int, optional):</span>
<span class="sd">                The identification number of the document.</span>
<span class="sd">                Defaults to -1.</span>
<span class="sd">        full_name_orig (str, optional):</span>
<span class="sd">                The file name of the originating document. Defaults to &quot;&quot;.</span>
<span class="sd">        no_lines_footer (int, optional):</span>
<span class="sd">                Total number of footer lines.</span>
<span class="sd">                Defaults to -1.</span>
<span class="sd">        no_lines_header (int, optional):</span>
<span class="sd">                Total number of header lines.</span>
<span class="sd">                Defaults to -1.</span>
<span class="sd">        no_lines_toc (int, optional):</span>
<span class="sd">                Total number of TOC lines.</span>
<span class="sd">                Defaults to -1.</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple[str, str]:</span>
<span class="sd">                (&quot;ok&quot;, &quot;&quot;) if the processing has been completed successfully,</span>
<span class="sd">                           otherwise a corresponding error code and error message.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">LOGGER_START</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">initialise_logger</span><span class="p">()</span>
        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">LOGGER_START</span><span class="p">)</span>

    <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;param document_id    =</span><span class="si">%i</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">document_id</span><span class="p">)</span>
    <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;param full_name_in   =</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">full_name_in</span><span class="p">)</span>
    <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;param full_name_orig =</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">full_name_orig</span><span class="p">)</span>
    <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;param full_name_out  =</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">full_name_out</span><span class="p">)</span>
    <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;param no_lines_footer=</span><span class="si">%i</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">no_lines_footer</span><span class="p">)</span>
    <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;param no_lines_header=</span><span class="si">%i</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">no_lines_header</span><span class="p">)</span>
    <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;param no_lines_toc   =</span><span class="si">%i</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">no_lines_toc</span><span class="p">)</span>
    <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;param pipeline_name  =</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">pipeline_name</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">text_parser</span> <span class="o">=</span> <span class="n">dcr_core</span><span class="o">.</span><span class="n">cls_text_parser</span><span class="o">.</span><span class="n">TextParser</span><span class="o">.</span><span class="n">from_files</span><span class="p">(</span>
            <span class="n">file_encoding</span><span class="o">=</span><span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">FILE_ENCODING_DEFAULT</span><span class="p">,</span> <span class="n">full_name_line</span><span class="o">=</span><span class="n">full_name_in</span>
        <span class="p">)</span>

        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">tokenizer_spacy</span><span class="o">.</span><span class="n">process_document</span><span class="p">(</span>
            <span class="n">document_id</span><span class="o">=</span><span class="n">document_id</span><span class="p">,</span>
            <span class="n">file_name_next</span><span class="o">=</span><span class="n">full_name_out</span><span class="p">,</span>
            <span class="n">file_name_orig</span><span class="o">=</span><span class="n">full_name_orig</span><span class="p">,</span>
            <span class="n">no_lines_footer</span><span class="o">=</span><span class="n">no_lines_footer</span><span class="p">,</span>
            <span class="n">no_lines_header</span><span class="o">=</span><span class="n">no_lines_header</span><span class="p">,</span>
            <span class="n">no_lines_toc</span><span class="o">=</span><span class="n">no_lines_toc</span><span class="p">,</span>
            <span class="n">pipeline_name</span><span class="o">=</span><span class="n">pipeline_name</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
        <span class="n">error_msg</span> <span class="o">=</span> <span class="n">Process</span><span class="o">.</span><span class="n">ERROR_71_901</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{full_name}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">full_name_in</span><span class="p">)</span>
        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;return               =</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">error_msg</span><span class="p">[:</span><span class="mi">6</span><span class="p">],</span> <span class="n">error_msg</span><span class="p">))</span>
        <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">LOGGER_END</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">error_msg</span><span class="p">[:</span><span class="mi">6</span><span class="p">],</span> <span class="n">error_msg</span>

    <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;return               =</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">RETURN_OK</span><span class="p">)</span>
    <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">LOGGER_END</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">dcr_core</span><span class="o">.</span><span class="n">core_glob</span><span class="o">.</span><span class="n">RETURN_OK</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy;2021-2022, Konnexions GmbH.
    </div>
  
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "..", "features": ["search.highlight", "search.suggest"], "search": "../assets/javascripts/workers/search.db81ec45.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.a00a7c5e.min.js"></script>
      
        <script src="https://unpkg.com/mermaid@8.13.3/dist/mermaid.min.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
        <script src="../assets/pymdownx-extras/extra-loader-9e2c67b9.js"></script>
      
    
  </body>
</html>